!function(){CodeMirror.defineExtension("autoFormatAll",function(e,t){for(var n=this,a=n.getMode(),i=n.getRange(e,t).split("\n"),o=CodeMirror.copyState(a,n.getTokenAt(e).state),r=n.getOption("tabSize"),l="",s=0,d=0==e.ch,c=0;c<i.length;++c){for(var u=new CodeMirror.StringStream(i[c],r);!u.eol();){var p=CodeMirror.innerMode(a,o),m=a.token(u,o),h=u.current();u.start=u.pos,(!d||/\S/.test(h))&&(l+=h,d=!1),!d&&p.mode.newlineAfterToken&&p.mode.newlineAfterToken(m,h,u.string.slice(u.pos)||i[c+1]||"",p.state)&&(l+="\n",d=!0,++s)}!u.pos&&a.blankLine&&a.blankLine(o),!d&&c<i.length-1&&(l+="\n",d=!0,++s)}n.operation(function(){n.replaceRange(l,e,t);for(var a=e.line+1,i=e.line+s;i>=a;++a)n.indentLine(a,"smart");n.setCursor({line:0,ch:0})})})}();