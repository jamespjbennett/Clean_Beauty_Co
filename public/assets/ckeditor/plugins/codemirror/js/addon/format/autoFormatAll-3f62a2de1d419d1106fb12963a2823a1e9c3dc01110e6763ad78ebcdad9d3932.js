!function(){CodeMirror.defineExtension("autoFormatAll",function(e,t){for(var n=this,i=n.getMode(),a=n.getRange(e,t).split("\n"),o=CodeMirror.copyState(i,n.getTokenAt(e).state),r=n.getOption("tabSize"),s="",l=0,d=0==e.ch,c=0;c<a.length;++c){for(var u=new CodeMirror.StringStream(a[c],r);!u.eol();){var p=CodeMirror.innerMode(i,o),m=i.token(u,o),h=u.current();u.start=u.pos,(!d||/\S/.test(h))&&(s+=h,d=!1),!d&&p.mode.newlineAfterToken&&p.mode.newlineAfterToken(m,h,u.string.slice(u.pos)||a[c+1]||"",p.state)&&(s+="\n",d=!0,++l)}!u.pos&&i.blankLine&&i.blankLine(o),!d&&c<a.length-1&&(s+="\n",d=!0,++l)}n.operation(function(){n.replaceRange(s,e,t);for(var i=e.line+1,a=e.line+l;a>=i;++i)n.indentLine(i,"smart");n.setCursor({line:0,ch:0})})})}();