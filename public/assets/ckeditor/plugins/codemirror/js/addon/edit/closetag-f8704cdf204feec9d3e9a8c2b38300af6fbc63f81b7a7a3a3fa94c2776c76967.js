!function(){function e(e,i){var o=e.getCursor(),r=e.getTokenAt(o),l=CodeMirror.innerMode(e.getMode(),r.state),s=l.state;if("xml"!=l.mode.name)return CodeMirror.Pass;var d=e.getOption("autoCloseTags"),c="html"==l.mode.configuration,l="object"==typeof d&&d.dontCloseTags||c&&n,c="object"==typeof d&&d.indentTags||c&&a;if(">"==i&&s.tagName){d=s.tagName,r.end>o.ch&&(d=d.slice(0,d.length-r.end+o.ch));var u=d.toLowerCase();if("tag"==r.type&&"closeTag"==s.type||/\/\s*$/.test(r.string)||l&&-1<t(l,u))return CodeMirror.Pass;s=(r=c&&-1<t(c,u))?CodeMirror.Pos(o.line+1,0):CodeMirror.Pos(o.line,o.ch+1),e.replaceSelection(">"+(r?"\n\n":"")+"</"+d+">",{head:s,anchor:s}),r&&(e.indentLine(o.line+1),e.indentLine(o.line+2))}else{if("/"!=i||"<"!=r.string)return CodeMirror.Pass;(d=s.context&&s.context.tagName)&&e.replaceSelection("/"+d+">","end")}}function t(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,a=e.length;a>n;++n)if(e[n]==t)return n;return-1}CodeMirror.defineOption("autoCloseTags",!1,function(t,n,a){!n||a!=CodeMirror.Init&&a?!n&&a!=CodeMirror.Init&&a&&t.removeKeyMap("autoCloseTags"):(a={name:"autoCloseTags"},("object"!=typeof n||n.whenClosing)&&(a["'/'"]=function(t){return e(t,"/")}),("object"!=typeof n||n.whenOpening)&&(a["'>'"]=function(t){return e(t,">")}),t.addKeyMap(a))});var n="area base br col command embed hr img input keygen link meta param source track wbr".split(" "),a="applet blockquote body button div dl fieldset form frameset h1 h2 h3 h4 h5 h6 head html iframe layer legend object ol p select table ul".split(" ")}();