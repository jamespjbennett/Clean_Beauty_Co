CodeMirror.tagRangeFinder=function(e,t){for(var n=RegExp("^[A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*"),a=e.getLine(t.line),i=!1,o=null,r=t.ch;!i;){if(r=a.indexOf("<",r),-1==r)return;if(r+1<a.length&&"/"==a[r+1])r++;else if(a.substr(r+1).match(n)){var l=a.indexOf(">",r+1);if(-1==l){for(var i=t.line+1,s=!1,d=e.lineCount();d>i&&!s;){var c=e.getLine(i),l=c.indexOf(">");if(-1!=l&&(s=!0,c=c.lastIndexOf("/",l),-1!=c&&l>c&&(c=a.substr(c,l-c+1),!c.match(/\/\s*\>/))))return;i++}i=!0}else d=a.lastIndexOf("/",l),-1==d?i=!0:(c=a.substr(d,l-d+1),c.match(/\/\s*\>/)||(i=!0));i&&((o=a.substr(r+1).match(n))?(o=o[0],-1!=a.indexOf("</"+o+">",r)&&(i=!1)):i=!1),i||r++}else r++}if(i)for(n=RegExp("(\\<\\/"+o+"\\>)|(\\<"+o+"\\>)|(\\<"+o+"\\s)|(\\<"+o+"$)"),o="</"+o+">",r=1,i=t.line+1,d=e.lineCount();d>i;){if(a=e.getLine(i),a=a.match(n))for(s=0;s<a.length;s++)if(a[s]==o?r--:r++,!r)return{from:CodeMirror.Pos(t.line,l+1),to:CodeMirror.Pos(i,a.index)};i++}},CodeMirror.braceRangeFinder=function(e,t){for(var n,a,i=t.line,o=e.getLine(i),r=o.length;r=o.lastIndexOf("{",r),!(r<t.ch);){if(a=e.getTokenAt(CodeMirror.Pos(i,r+1)).type,!/^(comment|string)/.test(a)){n=r;break}r-=1}if(!(null==n||o.lastIndexOf("}")>n)){var l,s,o=1,r=e.lineCount(),d=i+1;e:for(;r>d;++d)for(var c=e.getLine(d),u=0;;){var p=c.indexOf("{",u),u=c.indexOf("}",u);if(0>p&&(p=c.length),0>u&&(u=c.length),u=Math.min(p,u),u==c.length)break;if(e.getTokenAt(CodeMirror.Pos(d,u+1)).type==a)if(u==p)++o;else if(!--o){l=d,s=u;break e}++u}if(null!=l&&l!=i+1)return{from:CodeMirror.Pos(i,n+1),to:CodeMirror.Pos(l,s)}}},CodeMirror.indentRangeFinder=function(e,t){for(var n=e.getOption("tabSize"),a=e.getLine(t.line),i=CodeMirror.countColumn(a,null,n),o=t.line+1,r=e.lineCount();r>o;++o){var l=e.getLine(o);if(CodeMirror.countColumn(l,null,n)<i&&CodeMirror.countColumn(e.getLine(o-1),null,n)>i)return{from:CodeMirror.Pos(t.line,a.length),to:CodeMirror.Pos(o,l.length)}}},CodeMirror.newFoldFunction=function(e,t){if(null==t&&(t="\u2194"),"string"==typeof t){var n=document.createTextNode(t),t=document.createElement("span");t.appendChild(n),t.className="CodeMirror-foldmarker"}return function(n,a){"number"==typeof a&&(a=CodeMirror.Pos(a,0));var i=e(n,a);if(i){for(var o=n.findMarksAt(i.from),r=0,l=0;l<o.length;++l)o[l].__isFold&&(++r,o[l].clear());if(!r){o=t.cloneNode(!0),CodeMirror.on(o,"mousedown",function(){s.clear()});var s=n.markText(i.from,i.to,{replacedWith:o,clearOnEnter:!0,__isFold:!0})}}}};