CodeMirror.tagRangeFinder=function(e,t){for(var n=RegExp("^[A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*"),i=e.getLine(t.line),a=!1,o=null,r=t.ch;!a;){if(r=i.indexOf("<",r),-1==r)return;if(r+1<i.length&&"/"==i[r+1])r++;else if(i.substr(r+1).match(n)){var s=i.indexOf(">",r+1);if(-1==s){for(var a=t.line+1,l=!1,d=e.lineCount();d>a&&!l;){var c=e.getLine(a),s=c.indexOf(">");if(-1!=s&&(l=!0,c=c.lastIndexOf("/",s),-1!=c&&s>c&&(c=i.substr(c,s-c+1),!c.match(/\/\s*\>/))))return;a++}a=!0}else d=i.lastIndexOf("/",s),-1==d?a=!0:(c=i.substr(d,s-d+1),c.match(/\/\s*\>/)||(a=!0));a&&((o=i.substr(r+1).match(n))?(o=o[0],-1!=i.indexOf("</"+o+">",r)&&(a=!1)):a=!1),a||r++}else r++}if(a)for(n=RegExp("(\\<\\/"+o+"\\>)|(\\<"+o+"\\>)|(\\<"+o+"\\s)|(\\<"+o+"$)"),o="</"+o+">",r=1,a=t.line+1,d=e.lineCount();d>a;){if(i=e.getLine(a),i=i.match(n))for(l=0;l<i.length;l++)if(i[l]==o?r--:r++,!r)return{from:CodeMirror.Pos(t.line,s+1),to:CodeMirror.Pos(a,i.index)};a++}},CodeMirror.braceRangeFinder=function(e,t){for(var n,i,a=t.line,o=e.getLine(a),r=o.length;r=o.lastIndexOf("{",r),!(r<t.ch);){if(i=e.getTokenAt(CodeMirror.Pos(a,r+1)).type,!/^(comment|string)/.test(i)){n=r;break}r-=1}if(!(null==n||o.lastIndexOf("}")>n)){var s,l,o=1,r=e.lineCount(),d=a+1;e:for(;r>d;++d)for(var c=e.getLine(d),u=0;;){var p=c.indexOf("{",u),u=c.indexOf("}",u);if(0>p&&(p=c.length),0>u&&(u=c.length),u=Math.min(p,u),u==c.length)break;if(e.getTokenAt(CodeMirror.Pos(d,u+1)).type==i)if(u==p)++o;else if(!--o){s=d,l=u;break e}++u}if(null!=s&&s!=a+1)return{from:CodeMirror.Pos(a,n+1),to:CodeMirror.Pos(s,l)}}},CodeMirror.indentRangeFinder=function(e,t){for(var n=e.getOption("tabSize"),i=e.getLine(t.line),a=CodeMirror.countColumn(i,null,n),o=t.line+1,r=e.lineCount();r>o;++o){var s=e.getLine(o);if(CodeMirror.countColumn(s,null,n)<a&&CodeMirror.countColumn(e.getLine(o-1),null,n)>a)return{from:CodeMirror.Pos(t.line,i.length),to:CodeMirror.Pos(o,s.length)}}},CodeMirror.newFoldFunction=function(e,t){if(null==t&&(t="\u2194"),"string"==typeof t){var n=document.createTextNode(t),t=document.createElement("span");t.appendChild(n),t.className="CodeMirror-foldmarker"}return function(n,i){"number"==typeof i&&(i=CodeMirror.Pos(i,0));var a=e(n,i);if(a){for(var o=n.findMarksAt(a.from),r=0,s=0;s<o.length;++s)o[s].__isFold&&(++r,o[s].clear());if(!r){o=t.cloneNode(!0),CodeMirror.on(o,"mousedown",function(){l.clear()});var l=n.markText(a.from,a.to,{replacedWith:o,clearOnEnter:!0,__isFold:!0})}}}};