window.CodeMirror=function(){function e(n,a){if(!(this instanceof e))return new e(n,a);this.options=a=a||{};for(var i in gi)!a.hasOwnProperty(i)&&gi.hasOwnProperty(i)&&(a[i]=gi[i]);c(a),i=this.display=t(n,"string"==typeof a.value?0:a.value.first),i.wrapper.CodeMirror=this,l(this),a.autofocus&&!Za&&Z(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,draggingText:!1,highlight:new ua},o(this),a.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap");var r=a.value;"string"==typeof r&&(r=new Oi(a.value,a.mode)),$(this,Ln)(this,r),Fa&&setTimeout(Ta(X,this,!0),20),J(this);var s;try{s=document.activeElement==i.input}catch(d){}s||a.autofocus&&!Za?setTimeout(Ta(ht,this),20):gt(this),$(this,function(){for(var e in hi)hi.propertyIsEnumerable(e)&&hi[e](this,a[e],fi);for(e=0;e<Ei.length;++e)Ei[e](this)})()}function t(e,t){var n={},a=n.input=ka("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none;");ja?a.style.width="1000px":a.setAttribute("wrap","off"),a.setAttribute("autocorrect","off"),a.setAttribute("autocapitalize","off"),n.inputDiv=ka("div",[a],null,"overflow: hidden; position: relative; width: 3px; height: 0px;"),n.scrollbarH=ka("div",[ka("div",null,null,"height: 1px")],"CodeMirror-hscrollbar"),n.scrollbarV=ka("div",[ka("div",null,null,"width: 1px")],"CodeMirror-vscrollbar"),n.scrollbarFiller=ka("div",null,"CodeMirror-scrollbar-filler"),n.lineDiv=ka("div"),n.selectionDiv=ka("div",null,null,"position: relative; z-index: 1"),n.cursor=ka("div","\xa0","CodeMirror-cursor"),n.otherCursor=ka("div","\xa0","CodeMirror-cursor CodeMirror-secondarycursor"),n.measure=ka("div",null,"CodeMirror-measure"),n.lineSpace=ka("div",[n.measure,n.selectionDiv,n.lineDiv,n.cursor,n.otherCursor],null,"position: relative; outline: none"),n.mover=ka("div",[ka("div",[n.lineSpace],"CodeMirror-lines")],null,"position: relative"),n.sizer=ka("div",[n.mover],"CodeMirror-sizer"),n.heightForcer=ka("div","\xa0",null,"position: absolute; height: "+Ki+"px"),n.gutters=ka("div",null,"CodeMirror-gutters"),n.lineGutter=null;var i=ka("div",[n.sizer,n.heightForcer,n.gutters],null,"position: relative; min-height: 100%");return n.scroller=ka("div",[i],"CodeMirror-scroll"),n.scroller.setAttribute("tabIndex","-1"),n.wrapper=ka("div",[n.inputDiv,n.scrollbarH,n.scrollbarV,n.scrollbarFiller,n.scroller],"CodeMirror"),za&&(n.gutters.style.zIndex=-1,n.scroller.style.paddingRight=0),e.appendChild?e.appendChild(n.wrapper):e(n.wrapper),Xa&&(a.style.width="0px"),ja||(n.scroller.draggable=!0),Va?(n.inputDiv.style.height="1px",n.inputDiv.style.position="absolute"):za&&(n.scrollbarH.style.minWidth=n.scrollbarV.style.minWidth="18px"),n.viewOffset=n.lastSizeC=0,n.showingFrom=n.showingTo=t,n.lineNumWidth=n.lineNumInnerWidth=n.lineNumChars=null,n.prevInput="",n.alignWidgets=!1,n.pollingFast=!1,n.poll=new ua,n.draggingText=!1,n.cachedCharWidth=n.cachedTextHeight=null,n.measureLineCache=[],n.measureLineCachePos=0,n.inaccurateSelection=!1,n.maxLine=null,n.maxLineLength=0,n.maxLineChanged=!1,n.wheelDX=n.wheelDY=n.wheelStartX=n.wheelStartY=null,n}function n(t){t.doc.mode=e.getMode(t.options,t.doc.modeOption),t.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),t.doc.frontier=t.doc.first,D(t,100),t.state.modeGen++,t.curOp&&V(t)}function a(e){var t=z(e.display),n=e.options.lineWrapping,a=n&&Math.max(5,e.display.scroller.clientWidth/M(e.display)-3);return function(i){return hn(e.doc,i)?0:n?(Math.ceil(i.text.length/a)||1)*t:t}}function i(e){var t=e.doc,n=a(e);t.iter(function(e){var t=n(e);t!=e.height&&zn(e,t)})}function o(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),K(e)}function r(e){l(e),V(e)}function l(e){var t=e.display.gutters,n=e.options.gutters;ya(t);for(var a=0;a<n.length;++a){var i=n[a],o=t.appendChild(ka("div",null,"CodeMirror-gutter "+i));"CodeMirror-linenumbers"==i&&(e.display.lineGutter=o,o.style.width=(e.display.lineNumWidth||1)+"px")}t.style.display=a?"":"none"}function s(e,t){if(0==t.height)return 0;for(var n,a=t.text.length,i=t;n=un(i,-1);)n=n.find(),i=Pn(e,n.from.line),a+=n.from.ch-n.to.ch;for(i=t;n=pn(i);)n=n.find(),a-=i.text.length-n.from.ch,i=Pn(e,n.to.line),a+=i.text.length-n.to.ch;return a}function d(e){var t=e.display,n=e.doc;t.maxLine=Pn(n,n.first),t.maxLineLength=s(n,t.maxLine),t.maxLineChanged=!0,n.iter(function(e){var a=s(n,e);a>t.maxLineLength&&(t.maxLineLength=a,t.maxLine=e)})}function c(e){for(var t=!1,n=0;n<e.gutters.length;++n)"CodeMirror-linenumbers"==e.gutters[n]&&(e.lineNumbers?t=!0:e.gutters.splice(n--,1));!t&&e.lineNumbers&&e.gutters.push("CodeMirror-linenumbers")}function u(e,t){var n=t+2*e.lineSpace.offsetTop;e.sizer.style.minHeight=e.heightForcer.style.top=n+"px";var n=Math.max(n,e.scroller.scrollHeight),a=e.scroller.scrollWidth>e.scroller.clientWidth,i=n>e.scroller.clientHeight;i?(e.scrollbarV.style.display="block",e.scrollbarV.style.bottom=a?Oa(e.measure)+"px":"0",e.scrollbarV.firstChild.style.height=n-e.scroller.clientHeight+e.scrollbarV.clientHeight+"px"):e.scrollbarV.style.display="",a?(e.scrollbarH.style.display="block",e.scrollbarH.style.right=i?Oa(e.measure)+"px":"0",e.scrollbarH.firstChild.style.width=e.scroller.scrollWidth-e.scroller.clientWidth+e.scrollbarH.clientWidth+"px"):e.scrollbarH.style.display="",a&&i?(e.scrollbarFiller.style.display="block",e.scrollbarFiller.style.height=e.scrollbarFiller.style.width=Oa(e.measure)+"px"):e.scrollbarFiller.style.display="",qa&&0===Oa(e.measure)&&(e.scrollbarV.style.minWidth=e.scrollbarH.style.minHeight=Ga?"18px":"12px")}function p(e,t,n){var a=e.scroller.scrollTop,i=e.wrapper.clientHeight;return"number"==typeof n?a=n:n&&(a=n.top,i=n.bottom-n.top),a=Math.floor(a-e.lineSpace.offsetTop),e=Math.ceil(a+i),{from:jn(t,a),to:jn(t,e)}}function m(e){var t=e.display;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var n=g(t)-t.scroller.scrollLeft+e.doc.scrollLeft,a=t.gutters.offsetWidth,i=n+"px",o=t.lineDiv.firstChild;o;o=o.nextSibling)if(o.alignable)for(var r=0,l=o.alignable;r<l.length;++r)l[r].style.left=i;e.options.fixedGutter&&(t.gutters.style.left=n+a+"px")}}function h(e){if(!e.options.lineNumbers)return!1;var t=e.doc,t=""+e.options.lineNumberFormatter(t.first+t.size-1+e.options.firstLineNumber),e=e.display;if(t.length!=e.lineNumChars){var n=e.measure.appendChild(ka("div",[ka("div",t)],"CodeMirror-linenumber CodeMirror-gutter-elt")),a=n.firstChild.offsetWidth,n=n.offsetWidth-a;return e.lineGutter.style.width="",e.lineNumInnerWidth=Math.max(a,e.lineGutter.offsetWidth-n),e.lineNumWidth=e.lineNumInnerWidth+n,e.lineNumChars=e.lineNumInnerWidth?t.length:-1,e.lineGutter.style.width=e.lineNumWidth+"px",!0}return!1}function g(e){return Da(e.scroller).left-Da(e.sizer).left}function f(e,t,n){var a=e.display.showingFrom,i=e.display.showingTo;return(t=b(e,t,n))&&(sa(e,"update",e),(e.display.showingFrom!=a||e.display.showingTo!=i)&&sa(e,"viewportChange",e,e.display.showingFrom,e.display.showingTo)),y(e),u(e.display,e.doc.height),t}function b(e,t,n){var a=e.display,i=e.doc;if(a.wrapper.clientWidth){var o=p(a,i,n);if(!(0==t.length&&o.from>a.showingFrom&&o.to<a.showingTo)){h(e)&&(t=[{from:i.first,to:i.first+i.size}]);var r=a.sizer.style.marginLeft=a.gutters.offsetWidth+"px";a.scrollbarH.style.left=e.options.fixedGutter?r:"0";var l=1/0;if(e.options.lineNumbers)for(r=0;r<t.length;++r)if(t[r].diff){l=t[r].from;break}var r=i.first+i.size,s=Math.max(o.from-e.options.viewportMargin,i.first),o=Math.min(r,o.to+e.options.viewportMargin);if(a.showingFrom<s&&20>s-a.showingFrom&&(s=Math.max(i.first,a.showingFrom)),a.showingTo>o&&20>a.showingTo-o&&(o=Math.min(r,a.showingTo)),li)for(s=Mn(mn(i,Pn(i,s)));r>o&&hn(i,Pn(i,o));)++o;var d=[{from:Math.max(a.showingFrom,i.first),to:Math.min(a.showingTo,r)}],d=d[0].from>=d[0].to?[]:T(d,t);if(li)for(r=0;r<d.length;++r)for(var c,t=d[r];c=pn(Pn(i,t.to-1));){if(c=c.find().from.line,!(c>t.from)){d.splice(r--,1);break}t.to=c}for(r=c=0;r<d.length;++r)t=d[r],t.from<s&&(t.from=s),t.to>o&&(t.to=o),t.from>=t.to?d.splice(r--,1):c+=t.to-t.from;if(c!=o-s||s!=a.showingFrom||o!=a.showingTo){for(d.sort(function(e,t){return e.from-t.from}),r=document.activeElement,.7*(o-s)>c&&(a.lineDiv.style.display="none"),C(e,s,o,d,l),a.lineDiv.style.display="",document.activeElement!=r&&r.offsetHeight&&r.focus(),(s!=a.showingFrom||o!=a.showingTo||a.lastSizeC!=a.wrapper.clientHeight)&&(a.lastSizeC=a.wrapper.clientHeight),a.showingFrom=s,a.showingTo=o,D(e,100),l=a.lineDiv.offsetTop,s=a.lineDiv.firstChild;s;s=s.nextSibling)if(s.lineObj&&(za?(d=s.offsetTop+s.offsetHeight,r=d-l,l=d):(r=Da(s),r=r.bottom-r.top),d=s.lineObj.height-r,2>r&&(r=z(a)),d>.001||-.001>d)&&(zn(s.lineObj,r),d=s.lineObj.widgets))for(r=0;r<d.length;++r)d[r].height=d[r].node.offsetHeight;return v(e),p(a,i,n).to>o&&b(e,[],n),!0}v(e)}}else a.showingFrom=a.showingTo=i.first,a.viewOffset=0}function v(e){var t=e.display.viewOffset=Hn(e,Pn(e.doc,e.display.showingFrom));e.display.mover.style.top=t+"px"}function T(e,t){for(var n=0,a=t.length||0;a>n;++n){for(var i=t[n],o=[],r=i.diff||0,l=0,s=e.length;s>l;++l){var d=e[l];i.to<=d.from&&i.diff?o.push({from:d.from+r,to:d.to+r}):i.to<=d.from||i.from>=d.to?o.push(d):(i.from>d.from&&o.push({from:d.from,to:i.from}),i.to<d.to&&o.push({from:i.to+r,to:d.to+r}))}e=o}return e}function E(e){for(var t=e.display,n={},a={},i=t.gutters.firstChild,o=0;i;i=i.nextSibling,++o)n[e.options.gutters[o]]=i.offsetLeft,a[e.options.gutters[o]]=i.offsetWidth;return{fixedPos:g(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:n,gutterWidth:a,wrapperWidth:t.wrapper.clientWidth}}function C(e,t,n,a,i){function o(t){var n=t.nextSibling;return ja&&Qa&&e.display.currentWheelTarget==t?(t.style.display="none",t.lineObj=null):t.parentNode.removeChild(t),n}var r=E(e),l=e.display,s=e.options.lineNumbers;!(a.length||ja&&e.display.currentWheelTarget||!ya(l.lineDiv));var d=l.lineDiv,c=d.firstChild,u=a.shift(),p=t;for(e.doc.iter(t,n,function(t){if(u&&u.to==p&&(u=a.shift()),hn(e.doc,t)){if(0!=t.height&&zn(t,0),t.widgets&&c.previousSibling)for(var n=0;n<t.widgets.length;++n)if(t.widgets[n].showIfHidden){var l=c.previousSibling;if(/pre/i.test(l.nodeName)){var m=ka("div",null,null,"position: relative");l.parentNode.replaceChild(m,l),m.appendChild(l),l=m}m=l.appendChild(ka("div",[t.widgets[n].node],"CodeMirror-linewidget")),k(t.widgets[n],m,l,r)}}else if(u&&u.from<=p&&u.to>p){for(;c.lineObj!=t;)c=o(c);s&&p>=i&&c.lineNumber&&Ia(c.lineNumber,""+e.options.lineNumberFormatter(p+e.options.firstLineNumber)),c=c.nextSibling}else{if(t.widgets)for(var h=0,g=c;g&&20>h;++h,g=g.nextSibling)if(g.lineObj==t&&/div/i.test(g.nodeName)){n=g;break}var h=e,f=p,b=n,g=On(h,t),v=t.gutterMarkers,T=h.display;if(h.options.lineNumbers||v||t.bgClass||t.wrapClass||t.widgets){if(b){b.alignable=null;for(var E,C=!0,y=0,R=b.firstChild;R;R=E)if(E=R.nextSibling,/\bCodeMirror-linewidget\b/.test(R.className)){for(var I=0,D=!0;I<t.widgets.length;++I){var O=t.widgets[I],S=!1;if(O.above||(S=D,D=!1),O.node==R.firstChild){k(O,R,b,r),++y,S&&b.insertBefore(g,R);break}}if(I==t.widgets.length){C=!1;break}}else b.removeChild(R);C&&y==t.widgets.length&&(l=b,b.className=t.wrapClass||"")}if(l||(l=ka("div",null,t.wrapClass,"position: relative"),l.appendChild(g)),t.bgClass&&l.insertBefore(ka("div","\xa0",t.bgClass+" CodeMirror-linebackground"),l.firstChild),(h.options.lineNumbers||v)&&(m=l.insertBefore(ka("div",null,null,"position: absolute; left: "+(h.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px"),l.firstChild),h.options.fixedGutter&&(l.alignable||(l.alignable=[])).push(m),!h.options.lineNumbers||v&&v["CodeMirror-linenumbers"]||(l.lineNumber=m.appendChild(ka("div",""+h.options.lineNumberFormatter(f+h.options.firstLineNumber),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+r.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+T.lineNumInnerWidth+"px"))),v))for(I=0;I<h.options.gutters.length;++I)O=h.options.gutters[I],(f=v.hasOwnProperty(O)&&v[O])&&m.appendChild(ka("div",[f],"CodeMirror-gutter-elt","left: "+r.gutterLeft[O]+"px; width: "+r.gutterWidth[O]+"px"));if(za&&(l.style.zIndex=2),t.widgets&&l!=b)for(I=0,b=t.widgets;I<b.length;++I)O=b[I],v=ka("div",[O.node],"CodeMirror-linewidget"),k(O,v,l,r),O.above?l.insertBefore(v,h.options.lineNumbers&&0!=t.height?m:g):l.appendChild(v),sa(O,"redraw")}else l=g;if(l!=n)d.insertBefore(l,c);else{for(;c!=n;)c=o(c);c=c.nextSibling}l.lineObj=t}++p});c;)c=o(c)}function k(e,t,n,a){e.noHScroll&&((n.alignable||(n.alignable=[])).push(t),n=a.wrapperWidth,t.style.left=a.fixedPos+"px",e.coverGutter||(n-=a.gutterTotalWidth,t.style.paddingLeft=a.gutterTotalWidth+"px"),t.style.width=n+"px"),e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-a.gutterTotalWidth+"px"))}function y(e){var t=e.display,n=wt(e.doc.sel.from,e.doc.sel.to);if(n||e.options.showCursorWhenSelecting){var a=e.display,i=L(e,e.doc.sel.head,"div");a.cursor.style.left=i.left+"px",a.cursor.style.top=i.top+"px",a.cursor.style.height=Math.max(0,i.bottom-i.top)*e.options.cursorHeight+"px",a.cursor.style.display="",i.other?(a.otherCursor.style.display="",a.otherCursor.style.left=i.other.left+"px",a.otherCursor.style.top=i.other.top+"px",a.otherCursor.style.height=.85*(i.other.bottom-i.other.top)+"px"):a.otherCursor.style.display="none"}else t.cursor.style.display=t.otherCursor.style.display="none";n?t.selectionDiv.style.display="none":R(e),e=L(e,e.doc.sel.head,"div"),n=Da(t.wrapper),a=Da(t.lineDiv),t.inputDiv.style.top=Math.max(0,Math.min(t.wrapper.clientHeight-10,e.top+a.top-n.top))+"px",t.inputDiv.style.left=Math.max(0,Math.min(t.wrapper.clientWidth-10,e.left+a.left-n.left))+"px"}function R(e){function t(e,t,n,a){0>t&&(t=0),r.appendChild(ka("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px; top: "+t+"px; width: "+(null==n?l-e:n)+"px; height: "+(a-t)+"px"))}function n(n,a,o,r){var d=Pn(i,n),c=d.text.length,u=r?1/0:-1/0;return wa($n(d),a||0,null==o?c:o,function(i,p,m){var h=x(e,St(n,"rtl"==m?p-1:i),"div",d),m=x(e,St(n,"rtl"==m?i:p-1),"div",d),g=h.left,f=m.right;3<m.top-h.top&&(t(g,h.top,null,h.bottom),g=s,h.bottom<m.top&&t(g,h.bottom,null,m.top)),null==o&&p==c&&(f=l),null==a&&0==i&&(g=s),u=r?Math.min(m.top,u):Math.max(m.bottom,u),s+1>g&&(g=s),t(g,m.top,f-g,m.bottom)}),u}var a=e.display,i=e.doc,o=e.doc.sel,r=document.createDocumentFragment(),l=a.lineSpace.offsetWidth,s=Ra(e.display.measure,ka("pre",null,null,"text-align: left")).appendChild(ka("span","x")).offsetLeft;if(o.from.line==o.to.line)n(o.from.line,o.from.ch,o.to.ch);else{for(var d,c=Pn(i,o.from.line),u=c,p=[o.from.line,o.from.ch];u=pn(u);){if(u=u.find(),p.push(u.from.ch,u.to.line,u.to.ch),u.to.line==o.to.line){p.push(o.to.ch),d=!0;break}u=Pn(i,u.to.line)}if(d)for(o=0;o<p.length;o+=3)n(p[o],p[o+1],p[o+2]);else p=Pn(i,o.to.line),c=o.from.ch?n(o.from.line,o.from.ch,null,!1):Hn(e,c)-a.viewOffset,o=o.to.ch?n(o.to.line,un(p,-1)?null:0,o.to.ch,!0):Hn(e,p)-a.viewOffset,o>c&&t(s,c,null,o)}Ra(a.selectionDiv,r),a.selectionDiv.style.display=""}function I(e){var t=e.display;clearInterval(t.blinker);var n=!0;t.cursor.style.visibility=t.otherCursor.style.visibility="",t.blinker=setInterval(function(){t.cursor.offsetHeight&&(t.cursor.style.visibility=t.otherCursor.style.visibility=(n=!n)?"":"hidden")},e.options.cursorBlinkRate)}function D(e,t){e.doc.mode.startState&&e.doc.frontier<e.display.showingTo&&e.state.highlight.set(t,Ta(O,e))}function O(e){var t=e.doc;if(t.frontier<t.first&&(t.frontier=t.first),!(t.frontier>=e.display.showingTo)){var n,a=+new Date+e.options.workTime,i=Yt(t.mode,w(e,t.frontier)),o=[];t.iter(t.frontier,Math.min(t.first+t.size,e.display.showingTo+500),function(r){if(t.frontier>=e.display.showingFrom){var l=r.styles;r.styles=Rn(e,r,i);for(var s=!l||l.length!=r.styles.length,d=0;!s&&d<l.length;++d)s=l[d]!=r.styles[d];s&&(n&&n.end==t.frontier?n.end++:o.push(n={start:t.frontier,end:t.frontier+1})),r.stateAfter=Yt(t.mode,i)}else In(e,r,i),r.stateAfter=t.frontier%5==0?Yt(t.mode,i):null;return++t.frontier,+new Date>a?(D(e,e.options.workDelay),!0):void 0}),o.length&&$(e,function(){for(var e=0;e<o.length;++e)V(this,o[e].start,o[e].end)})()}}function S(e,t){for(var n,a,i=e.doc,o=t,r=t-100;o>r;--o){if(o<=i.first)return i.first;var l=Pn(i,o-1);if(l.stateAfter)return o;l=pa(l.text,null,e.options.tabSize),(null==a||n>l)&&(a=o-1,n=l)}return a}function w(e,t){var n=e.doc,a=e.display;if(!n.mode.startState)return!0;var i=S(e,t),o=i>n.first&&Pn(n,i-1).stateAfter,o=o?Yt(n.mode,o):Xt(n.mode);return n.iter(i,t,function(r){In(e,r,o),r.stateAfter=i==t-1||0==i%5||i>=a.showingFrom&&i<a.showingTo?Yt(n.mode,o):null,++i}),o}function _(e,t,n,a){for(var i=-1,a=a||A(e,t),e=n;;e+=i){var o=a[e];if(o)break;0>i&&0==e&&(i=1)}return{left:n>e?o.right:o.left,right:e>n?o.left:o.right,top:o.top,bottom:o.bottom}}function A(e,t){for(var n=e.display,a=e.display.measureLineCache,i=0;i<a.length;++i){var o=a[i];if(o.text==t.text&&o.markedSpans==t.markedSpans&&n.scroller.clientWidth==o.width&&o.classes==t.textClass+"|"+t.bgClass+"|"+t.wrapClass)return o.measure}var r=e.display,l=va(t.text.length),o=On(e,t,l);if(Fa&&!za&&!e.options.lineWrapping&&100<o.childNodes.length){for(var s=document.createDocumentFragment(),d=o.childNodes.length,i=0,c=Math.ceil(d/10);c>i;++i){for(var u=ka("div",null,null,"display: inline-block"),p=0;10>p&&d;++p)u.appendChild(o.firstChild),--d;s.appendChild(u)}o.appendChild(s)}for(Ra(r.measure,o),d=Da(r.lineDiv),c=[],s=va(t.text.length),u=o.offsetHeight,Ma&&r.measure.first!=o&&Ra(r.measure,o),i=0;i<l.length;++i)if(r=l[i]){for(var m=Da(r),h=Math.max(0,m.top-d.top),g=Math.min(m.bottom-d.top,u),p=0;p<c.length;p+=2){var f=c[p],b=c[p+1];if(!(f>g||h>b)&&(h>=f&&b>=g||f>=h&&g>=b||Math.min(g,b)-Math.max(h,f)>=g-h>>1)){c[p]=Math.min(h,f),c[p+1]=Math.max(g,b);break}}p==c.length&&c.push(h,g),h=m.right,r.measureRight&&(h=Da(r.measureRight).left),s[i]={left:m.left-d.left,right:h-d.left,top:p}}for(i=0;i<s.length;++i)(r=s[i])&&(l=r.top,r.top=c[l],r.bottom=c[l+1]);return e.options.lineWrapping||(i=o.lastChild,3==i.nodeType&&(i=o.appendChild(ka("span","\u200b"))),s.width=Da(i).right-d.left),o={text:t.text,width:n.scroller.clientWidth,markedSpans:t.markedSpans,measure:s,classes:t.textClass+"|"+t.bgClass+"|"+t.wrapClass},16==a.length?a[++n.measureLineCachePos%16]=o:a.push(o),s}function K(e){e.display.measureLineCache.length=e.display.measureLineCachePos=0,e.display.cachedCharWidth=e.display.cachedTextHeight=null,e.display.maxLineChanged=!0,e.display.lineNumChars=null}function N(e,t,n,a){if(t.widgets)for(var i=0;i<t.widgets.length;++i)if(t.widgets[i].above){var o=Tn(t.widgets[i]);n.top+=o,n.bottom+=o}return"line"==a?n:(a||(a="local"),t=Hn(e,t),"local"!=a&&(t-=e.display.viewOffset),"page"==a&&(e=Da(e.display.lineSpace),t+=e.top+(window.pageYOffset||(document.documentElement||document.body).scrollTop),e=e.left+(window.pageXOffset||(document.documentElement||document.body).scrollLeft),n.left+=e,n.right+=e),n.top+=t,n.bottom+=t,n)}function x(e,t,n,a){return a||(a=Pn(e.doc,t.line)),N(e,a,_(e,a,t.ch),n)}function L(e,t,n,a,i){function o(t,o){var r=_(e,a,t,i);return o?r.left=r.right:r.right=r.left,N(e,a,r,n)}a=a||Pn(e.doc,t.line),i||(i=A(e,a));var r=$n(a),t=t.ch;if(!r)return o(t);for(var l,s,d=r[0].level,c=0;c<r.length;++c){var u,p=r[c],m=p.level%2;if(p.from<t&&p.to>t)return o(t,m);var h=m?p.from:p.to;(m?p.to:p.from)==t?(p=c&&p.level<(u=r[c-1]).level?o(u.level%2?u.from:u.to-1,!0):o(m&&p.from!=p.to?t-1:t),m==d?l=p:s=p):h==t&&(u=c<r.length-1&&r[c+1],m||!(u&&u.from==u.to))&&(p=u&&p.level<u.level?o(u.level%2?u.to-1:u.from):o(m?t:t-1,!0),m==d?l=p:s=p)}return d&&!t&&(s=o(r[0].to-1)),l?(s&&(l.other=s),l):s}function P(e,t,n){return e=new St(e,t),n&&(e.outside=!0),e}function B(e,t,n){var a=e.doc,n=n+e.display.viewOffset;if(0>n)return P(a.first,0,!0);var i=jn(a,n),o=a.first+a.size-1;if(i>o)return P(a.first+a.size-1,Pn(a,o).text.length,!0);for(0>t&&(t=0);;){var o=Pn(a,i),i=F(e,o,i,t,n),r=(o=pn(o))&&o.find();if(!(o&&i.ch>=r.from.ch))return i;i=r.to.line}}function F(e,t,n,a,i){function o(a){return a=L(e,St(n,a),"line",t,d),l=!0,r>a.bottom?Math.max(0,a.left-s):r<a.top?a.left+s:(l=!1,a.left)}var r=i-Hn(e,t),l=!1,s=e.display.wrapper.clientWidth,d=A(e,t),c=$n(t),u=t.text.length,p=Aa(t),m=Ka(t),h=o(p),i=l,g=o(m),f=l;if(a>g)return P(n,m,f);for(;;){if(c?m==p||m==La(t,p,1):1>=m-p){for(p=(a=g-a>a-h)?p:m;Pi.test(t.text.charAt(p));)++p;return i=P(n,p,a?i:f),i.after=a,i}var b=Math.ceil(u/2),v=p+b;if(c)for(var v=p,T=0;b>T;++T)v=La(t,v,1);T=o(v),T>a?(m=v,g=T,(f=l)&&(g+=1e3),u-=b):(p=v,h=T,i=l,u=b)}}function z(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==ti){ti=ka("pre");for(var t=0;49>t;++t)ti.appendChild(document.createTextNode("x")),ti.appendChild(ka("br"));ti.appendChild(document.createTextNode("x"))}return Ra(e.measure,ti),t=ti.offsetHeight/50,t>3&&(e.cachedTextHeight=t),ya(e.measure),t||1}function M(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=ka("span","x"),n=ka("pre",[t]);return Ra(e.measure,n),t=t.offsetWidth,t>2&&(e.cachedCharWidth=t),t||10}function j(e){e.curOp={changes:[],updateInput:null,userSelChange:null,textChanged:null,selectionChanged:!1,updateMaxLine:!1,updateScrollPos:!1,id:++si},Ai++||(_i=[])}function H(e){var t=e.curOp,n=e.doc,a=e.display;if(e.curOp=null,t.updateMaxLine&&d(e),a.maxLineChanged&&!e.options.lineWrapping){var i=A(e,a.maxLine).width;a.sizer.style.minWidth=Math.max(0,i+3+Ki)+"px",a.maxLineChanged=!1,i=Math.max(0,a.sizer.offsetLeft+a.sizer.offsetWidth-a.scroller.clientWidth),i<n.scrollLeft&&!t.updateScrollPos&&rt(e,Math.min(a.scroller.scrollLeft,i),!0)}var o,r;if(t.updateScrollPos?o=t.updateScrollPos:t.selectionChanged&&a.scroller.clientHeight&&(o=L(e,n.sel.head),o=jt(e,o.left,o.top,o.left,o.bottom)),(t.changes.length||o&&null!=o.scrollTop)&&(r=f(e,t.changes,o&&o.scrollTop)),!r&&t.selectionChanged&&y(e),t.updateScrollPos?(a.scroller.scrollTop=a.scrollbarV.scrollTop=n.scrollTop=o.scrollTop,a.scroller.scrollLeft=a.scrollbarH.scrollLeft=n.scrollLeft=o.scrollLeft,m(e)):o&&(n=zt(e,e.doc.sel.head),e.state.focused)&&(a=e.display,o=Da(a.sizer),r=null,0>n.top+o.top?r=!0:n.bottom+o.top>(window.innerHeight||document.documentElement.clientHeight)&&(r=!1),null==r||Ya||((o="none"==a.cursor.style.display)&&(a.cursor.style.display="",a.cursor.style.left=n.left+"px",a.cursor.style.top=n.top-a.viewOffset+"px"),a.cursor.scrollIntoView(r),o&&(a.cursor.style.display="none"))),t.selectionChanged&&I(e),e.state.focused&&t.updateInput&&X(e,t.userSelChange),n=t.maybeHiddenMarkers,a=t.maybeUnhiddenMarkers,n)for(r=0;r<n.length;++r)n[r].lines.length||la(n[r],"hide");if(a)for(r=0;r<a.length;++r)a[r].lines.length&&la(a[r],"unhide");var l;if(--Ai||(l=_i,_i=null),t.textChanged&&la(e,"change",e,t.textChanged),t.selectionChanged&&la(e,"cursorActivity",e),l)for(r=0;r<l.length;++r)l[r]()}function $(e,t){return function(){var n=e||this,a=!n.curOp;a&&j(n);try{var i=t.apply(n,arguments)}finally{a&&H(n)}return i}}function U(e){return function(){var t,n=this.cm&&!this.cm.curOp;n&&j(this.cm);try{t=e.apply(this,arguments)}finally{n&&H(this.cm)}return t}}function W(e,t){var n,a=!e.curOp;a&&j(e);try{n=t()}finally{a&&H(e)}return n}function V(e,t,n,a){null==t&&(t=e.doc.first),null==n&&(n=e.doc.first+e.doc.size),e.curOp.changes.push({from:t,to:n,diff:a})}function q(e){e.display.pollingFast||e.display.poll.set(e.options.pollInterval,function(){Y(e),e.state.focused&&q(e)})}function G(e){function t(){Y(e)||n?(e.display.pollingFast=!1,q(e)):(n=!0,e.display.poll.set(60,t))}var n=!1;e.display.pollingFast=!0,e.display.poll.set(20,t)}function Y(e){var t=e.display.input,n=e.display.prevInput,a=e.doc,i=a.sel;if(!e.state.focused||Hi(t)||Q(e))return!1;var o=t.value;if(o==n&&wt(i.from,i.to))return!1;if(Fa&&o&&0===t.selectionStart)return X(e,!0),!1;var r=!e.curOp;r&&j(e),i.shift=!1;for(var l=0,s=Math.min(n.length,o.length);s>l&&n[l]==o[l];)++l;return s=i.from,i=i.to,l<n.length?s=St(s.line,s.ch-(n.length-l)):e.state.overwrite&&wt(s,i)&&!e.state.pasteIncoming&&(i=St(i.line,Math.min(Pn(a,i.line).text.length,i.ch+(o.length-l)))),n=e.curOp.updateInput,Ct(e.doc,{from:s,to:i,text:ji(o.slice(l)),origin:e.state.pasteIncoming?"paste":"+input"},"end"),e.curOp.updateInput=n,1e3<o.length?t.value=e.display.prevInput="":e.display.prevInput=o,r&&H(e),e.state.pasteIncoming=!1,!0}function X(e,t){var n,a,i=e.doc;wt(i.sel.from,i.sel.to)?t&&(e.display.prevInput=e.display.input.value=""):(e.display.prevInput="",n=$i&&(100<i.sel.to.line-i.sel.from.line||1e3<(a=e.getSelection()).length),e.display.input.value=n?"-":a||e.getSelection(),e.state.focused&&ga(e.display.input)),e.display.inaccurateSelection=n}function Z(e){"nocursor"!=e.options.readOnly&&(!Za||document.activeElement!=e.display.input)&&e.display.input.focus()}function Q(e){return e.options.readOnly||e.doc.cantEdit}function J(e){function t(){e.state.focused&&setTimeout(Ta(Z,e),0)}function n(){r.cachedCharWidth=r.cachedTextHeight=null,K(e),W(e,Ta(V,e))}function a(){for(var e=r.wrapper.parentNode;e&&e!=document.body;e=e.parentNode);e?setTimeout(a,5e3):ra(window,"resize",n)}function i(t){(!e.options.onDragEvent||!e.options.onDragEvent(e,ea(t)))&&aa(t)}function o(){r.inaccurateSelection&&(r.prevInput="",r.inaccurateSelection=!1,r.input.value=e.getSelection(),ga(r.input))}var r=e.display;oa(r.scroller,"mousedown",$(e,nt)),oa(r.scroller,"dblclick",$(e,ta)),oa(r.lineSpace,"selectstart",function(e){et(r,e)||ta(e)}),oi||oa(r.scroller,"contextmenu",function(t){ft(e,t)}),oa(r.scroller,"scroll",function(){ot(e,r.scroller.scrollTop),rt(e,r.scroller.scrollLeft,!0),la(e,"scroll",e)}),oa(r.scrollbarV,"scroll",function(){ot(e,r.scrollbarV.scrollTop)}),oa(r.scrollbarH,"scroll",function(){rt(e,r.scrollbarH.scrollLeft)}),oa(r.scroller,"mousewheel",function(t){lt(e,t)}),oa(r.scroller,"DOMMouseScroll",function(t){lt(e,t)}),oa(r.scrollbarH,"mousedown",t),oa(r.scrollbarV,"mousedown",t),oa(r.wrapper,"scroll",function(){r.wrapper.scrollTop=r.wrapper.scrollLeft=0}),oa(window,"resize",n),setTimeout(a,5e3),oa(r.input,"keyup",$(e,function(t){e.options.onKeyEvent&&e.options.onKeyEvent(e,ea(t))||16!=t.keyCode||(e.doc.sel.shift=!1)})),oa(r.input,"input",Ta(G,e)),oa(r.input,"keydown",$(e,pt)),oa(r.input,"keypress",$(e,mt)),oa(r.input,"focus",Ta(ht,e)),oa(r.input,"blur",Ta(gt,e)),e.options.dragDrop&&(oa(r.scroller,"dragstart",function(t){var n=e;if(!et(n.display,t)){var a=n.getSelection();t.dataTransfer.setData("Text",a),t.dataTransfer.setDragImage&&!Wa&&(a=ka("img",null,null,"position: fixed; left: 0; top: 0;"),Ua&&(a.width=a.height=1,n.display.wrapper.appendChild(a),a._top=a.offsetTop),t.dataTransfer.setDragImage(a,0,0),Ua&&a.parentNode.removeChild(a))}}),oa(r.scroller,"dragenter",i),oa(r.scroller,"dragover",i),oa(r.scroller,"drop",$(e,at))),oa(r.scroller,"paste",function(t){et(r,t)||(Z(e),G(e))}),oa(r.input,"paste",function(){e.state.pasteIncoming=!0,G(e)}),oa(r.input,"cut",o),oa(r.input,"copy",o),Va&&oa(r.sizer,"mouseup",function(){document.activeElement==r.input&&r.input.blur(),Z(e)})}function et(e,t){for(var n=t.target||t.srcElement;n!=e.wrapper;n=n.parentNode)if(!n||/\bCodeMirror-(?:line)?widget\b/.test(n.className)||n.parentNode==e.sizer&&n!=e.mover)return!0}function tt(e,t,n){var a=e.display;if(!n&&(n=t.target||t.srcElement,n==a.scrollbarH||n==a.scrollbarH.firstChild||n==a.scrollbarV||n==a.scrollbarV.firstChild||n==a.scrollbarFiller))return null;var i,o,a=Da(a.lineSpace);try{i=t.clientX,o=t.clientY}catch(r){return null}return B(e,i-a.left,o-a.top)}function nt(e){function t(e){if("single"==c)Lt(i.doc,Kt(r,s),e);else if(m=Kt(r,m),h=Kt(r,h),"double"==c){var t=Vt(Pn(r,e.line).text,e);_t(e,m)?Lt(i.doc,t.from,h):Lt(i.doc,m,t.to)}else"triple"==c&&(_t(e,m)?Lt(i.doc,h,Kt(r,St(e.line,0))):Lt(i.doc,m,Kt(r,St(e.line+1,0))))}function n(e){var a=++f,l=tt(i,e,!0);if(l)if(wt(l,u)){var s=e.clientY<g.top?-20:e.clientY>g.bottom?20:0;s&&setTimeout($(i,function(){f==a&&(o.scroller.scrollTop+=s,n(e))}),50)}else{i.state.focused||ht(i),u=l,t(l);var d=p(o,r);(l.line>=d.to||l.line<d.from)&&setTimeout($(i,function(){f==a&&n(e)}),150)}}function a(e){f=1/0;var n=tt(i,e);n&&t(n),ta(e),Z(i),ra(document,"mousemove",b),ra(document,"mouseup",v)}var i=this,o=i.display,r=i.doc,l=r.sel;if(l.shift=e.shiftKey,et(o,e))ja||(o.scroller.draggable=!1,setTimeout(function(){o.scroller.draggable=!0},100));else if(!it(i,e)){var s=tt(i,e);switch(ia(e)){case 3:return void(oi&&ft.call(i,i,e));case 2:return s&&Lt(i.doc,s),setTimeout(Ta(Z,i),20),void ta(e)}if(s){i.state.focused||ht(i);var d=+new Date,c="single";ai&&ai.time>d-400&&wt(ai.pos,s)?(c="triple",ta(e),setTimeout(Ta(Z,i),20),qt(i,s.line)):ni&&ni.time>d-400&&wt(ni.pos,s)?(c="double",ai={time:d,pos:s},ta(e),d=Vt(Pn(r,s.line).text,s),Lt(i.doc,d.from,d.to)):ni={time:d,pos:s};var u=s;if(!i.options.dragDrop||!Bi||Q(i)||wt(l.from,l.to)||_t(s,l.from)||_t(l.to,s)||"single"!=c){ta(e),"single"==c&&Lt(i.doc,Kt(r,s));var m=l.from,h=l.to,g=Da(o.wrapper),f=0,b=$(i,function(e){Fa||ia(e)?n(e):a(e)}),v=$(i,a);oa(document,"mousemove",b),oa(document,"mouseup",v)}else{var T=$(i,function(t){ja&&(o.scroller.draggable=!1),i.state.draggingText=!1,ra(document,"mouseup",T),ra(o.scroller,"drop",T),Math.abs(e.clientX-t.clientX)+Math.abs(e.clientY-t.clientY)<10&&(ta(t),Lt(i.doc,s),Z(i))});ja&&(o.scroller.draggable=!0),i.state.draggingText=T,o.scroller.dragDrop&&o.scroller.dragDrop(),oa(document,"mouseup",T),oa(o.scroller,"drop",T)}}else(e.target||e.srcElement)==o.scroller&&ta(e)}}function at(e){var t=this;if(!(et(t.display,e)||t.options.onDragEvent&&t.options.onDragEvent(t,ea(e)))){ta(e);var n=tt(t,e,!0),a=e.dataTransfer.files;if(n&&!Q(t))if(a&&a.length&&window.FileReader&&window.File)for(var i=a.length,o=Array(i),r=0,e=function(e,a){var l=new FileReader;l.onload=function(){o[a]=l.result,++r==i&&(n=Kt(t.doc,n),Ot(t.doc,o.join(""),n,"around","paste"))},l.readAsText(e)},l=0;i>l;++l)e(a[l],l);else if(!t.state.draggingText||_t(n,t.doc.sel.from)||_t(t.doc.sel.to,n))try{if(o=e.dataTransfer.getData("Text")){var l=t.doc.sel.from,s=t.doc.sel.to;Pt(t.doc,n,n),t.state.draggingText&&Ot(t.doc,"",l,s,"paste"),t.replaceSelection(o,null,"paste"),Z(t),ht(t)}}catch(d){}else t.state.draggingText(e),setTimeout(Ta(Z,t),20)}}function it(e,t){var n=e.display;try{var a=t.clientX,i=t.clientY}catch(o){return!1}if(a>=Math.floor(Da(n.gutters).right))return!1;if(ta(t),!ca(e,"gutterClick"))return!0;var r=Da(n.lineDiv);if(i>r.bottom)return!0;for(i-=r.top-n.viewOffset,r=0;r<e.options.gutters.length;++r){var l=n.gutters.childNodes[r];if(l&&Da(l).right>=a){n=jn(e.doc,i),sa(e,"gutterClick",e,n,e.options.gutters[r],t);break}}return!0}function ot(e,t){2>Math.abs(e.doc.scrollTop-t)||(e.doc.scrollTop=t,Ba||f(e,[],t),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t),e.display.scrollbarV.scrollTop!=t&&(e.display.scrollbarV.scrollTop=t),Ba&&f(e,[]))}function rt(e,t,n){(n?t==e.doc.scrollLeft:2>Math.abs(e.doc.scrollLeft-t))||(t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),e.doc.scrollLeft=t,m(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbarH.scrollLeft!=t&&(e.display.scrollbarH.scrollLeft=t))}function lt(e,t){var n=t.wheelDeltaX,a=t.wheelDeltaY;if(null==n&&t.detail&&t.axis==t.HORIZONTAL_AXIS&&(n=t.detail),null==a&&t.detail&&t.axis==t.VERTICAL_AXIS?a=t.detail:null==a&&(a=t.wheelDelta),a&&Qa&&ja)for(var i=t.target;i!=r;i=i.parentNode)if(i.lineObj){e.display.currentWheelTarget=i;break}var o=e.display,r=o.scroller;if(!n||Ba||Ua||null==ci){if(a&&null!=ci){var i=a*ci,l=e.doc.scrollTop,s=l+o.wrapper.clientHeight;0>i?l=Math.max(0,l+i-50):s=Math.min(e.doc.height,s+i+50),f(e,[],{top:l,bottom:s})}20>di&&(null==o.wheelStartX?(o.wheelStartX=r.scrollLeft,o.wheelStartY=r.scrollTop,o.wheelDX=n,o.wheelDY=a,setTimeout(function(){if(null!=o.wheelStartX){var e=r.scrollLeft-o.wheelStartX,t=r.scrollTop-o.wheelStartY,e=t&&o.wheelDY&&t/o.wheelDY||e&&o.wheelDX&&e/o.wheelDX;o.wheelStartX=o.wheelStartY=null,e&&(ci=(ci*di+e)/(di+1),++di)}},200)):(o.wheelDX+=n,o.wheelDY+=a))}else a&&ot(e,Math.max(0,Math.min(r.scrollTop+a*ci,r.scrollHeight-r.clientHeight))),rt(e,Math.max(0,Math.min(r.scrollLeft+n*ci,r.scrollWidth-r.clientWidth))),ta(t),o.wheelStartX=null}function st(e,t,n){if("string"==typeof t&&(t=Ci[t],!t))return!1;e.display.pollingFast&&Y(e)&&(e.display.pollingFast=!1);var a=e.doc,i=a.sel.shift,o=!1;try{Q(e)&&(e.state.suppressEdits=!0),n&&(a.sel.shift=!1),o=t(e)!=Ni}finally{a.sel.shift=i,e.state.suppressEdits=!1}return o}function dt(e){var t=e.state.keyMaps.slice(0);return t.push(e.options.keyMap),e.options.extraKeys&&t.unshift(e.options.extraKeys),t}function ct(e,t){var n=Zt(e.options.keyMap),a=n.auto;clearTimeout(ui),a&&!Jt(t)&&(ui=setTimeout(function(){Zt(e.options.keyMap)==n&&(e.options.keyMap=a.call?a.call(null,e):a)},50));var i=en(t,!0),o=!1;return i?(o=dt(e),o=t.shiftKey?Qt("Shift-"+i,o,function(t){return st(e,t,!0)
})||Qt(i,o,function(t){return"string"==typeof t&&/^go[A-Z]/.test(t)?st(e,t):void 0}):Qt(i,o,function(t){return st(e,t)}),"stop"==o&&(o=!1),o&&(ta(t),I(e),Ma&&(t.oldKeyCode=t.keyCode,t.keyCode=0)),o):!1}function ut(e,t,n){return(n=Qt("'"+n+"'",dt(e),function(t){return st(e,t,!0)}))&&(ta(t),I(e)),n}function pt(e){if(this.state.focused||ht(this),Fa&&27==e.keyCode&&(e.returnValue=!1),!this.options.onKeyEvent||!this.options.onKeyEvent(this,ea(e))){var t=e.keyCode;this.doc.sel.shift=16==t||e.shiftKey;var n=ct(this,e);Ua&&(mi=n?t:null,!n&&88==t&&!$i&&(Qa?e.metaKey:e.ctrlKey)&&this.replaceSelection(""))}}function mt(e){var t=this;if(!t.options.onKeyEvent||!t.options.onKeyEvent(t,ea(e))){var n=e.keyCode,a=e.charCode;Ua&&n==mi?(mi=null,ta(e)):(Ua&&(!e.which||10>e.which)||Va)&&ct(t,e)||(n=String.fromCharCode(null==a?n:a),this.options.electricChars&&this.doc.mode.electricChars&&this.options.smartIndent&&!Q(this)&&-1<this.doc.mode.electricChars.indexOf(n)&&setTimeout($(t,function(){Ht(t,t.doc.sel.to.line,"smart")}),75),ut(t,e,n)||G(t))}}function ht(e){"nocursor"!=e.options.readOnly&&(e.state.focused||(la(e,"focus",e),e.state.focused=!0,-1==e.display.wrapper.className.search(/\bCodeMirror-focused\b/)&&(e.display.wrapper.className+=" CodeMirror-focused"),X(e,!0)),q(e),I(e))}function gt(e){e.state.focused&&(la(e,"blur",e),e.state.focused=!1,e.display.wrapper.className=e.display.wrapper.className.replace(" CodeMirror-focused","")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.doc.sel.shift=!1)},150)}function ft(e,t){function n(){if(a.inputDiv.style.position="relative",a.input.style.cssText=l,Ma&&(a.scrollbarV.scrollTop=a.scroller.scrollTop=r),q(e),null!=a.input.selectionStart&&(!Fa||Ma)){clearTimeout(pi);var t=a.input.value=" "+(wt(i.from,i.to)?"":a.input.value),n=0;a.prevInput=" ",a.input.selectionStart=1,a.input.selectionEnd=t.length;var o=function(){" "==a.prevInput&&0==a.input.selectionStart?$(e,Ci.selectAll)(e):n++<10?pi=setTimeout(o,500):X(e)};pi=setTimeout(o,200)}}var a=e.display,i=e.doc.sel;if(!et(a,t)){var o=tt(e,t),r=a.scroller.scrollTop;if(o&&!Ua){(wt(i.from,i.to)||_t(o,i.from)||!_t(o,i.to))&&$(e,Pt)(e.doc,o,o);var l=a.input.style.cssText;if(a.inputDiv.style.position="absolute",a.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(t.clientY-5)+"px; left: "+(t.clientX-5)+"px; z-index: 1000; background: white; outline: none;border-width: 0; outline: none; overflow: hidden; opacity: .05; -ms-opacity: .05; filter: alpha(opacity=5);",Z(e),X(e,!0),wt(i.from,i.to)&&(a.input.value=a.prevInput=" "),oi){aa(t);var s=function(){ra(window,"mouseup",s),setTimeout(n,20)};oa(window,"mouseup",s)}else setTimeout(n,50)}}}function bt(e){return St(e.from.line+e.text.length-1,ha(e.text).length+(1==e.text.length?e.from.ch:0))}function vt(e,t,n){if(!_t(t.from,n))return Kt(e,n);var a=t.text.length-1-(t.to.line-t.from.line);return n.line>t.to.line+a?(t=n.line-a,a=e.first+e.size-1,t>a?St(a,Pn(e,a).text.length):Nt(n,Pn(e,t).text.length)):n.line==t.to.line+a?Nt(n,ha(t.text).length+(1==t.text.length?t.from.ch:0)+Pn(e,t.to.line).text.length-t.to.ch):(e=n.line-t.from.line,Nt(n,t.text[e].length+(e?0:t.from.ch)))}function Tt(e,t,n){if(n&&"object"==typeof n)return{anchor:vt(e,t,n.anchor),head:vt(e,t,n.head)};if("start"==n)return{anchor:t.from,head:t.from};var a=bt(t);return"around"==n?{anchor:t.from,head:a}:"end"==n?{anchor:a,head:a}:(n=function(e){if(_t(e,t.from))return e;if(!_t(t.to,e))return a;var n=e.line+t.text.length-(t.to.line-t.from.line)-1,i=e.ch;return e.line==t.to.line&&(i+=a.ch-t.to.ch),St(n,i)},{anchor:n(e.sel.anchor),head:n(e.sel.head)})}function Et(e,t){var n={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,update:function(t,n,a,i){t&&(this.from=Kt(e,t)),n&&(this.to=Kt(e,n)),a&&(this.text=a),void 0!==i&&(this.origin=i)},cancel:function(){this.canceled=!0}};return la(e,"beforeChange",e,n),e.cm&&la(e.cm,"beforeChange",e.cm,n),n.canceled?null:{from:n.from,to:n.to,text:n.text,origin:n.origin}}function Ct(e,t,n,a){if(e.cm){if(!e.cm.curOp)return $(e.cm,Ct)(e,t,n,a);if(e.cm.state.suppressEdits)return}if(!(ca(e,"beforeChange")||e.cm&&ca(e.cm,"beforeChange"))||(t=Et(e,t)))if(a=ri&&!a&&cn(e,t.from,t.to)){for(var i=a.length-1;i>=1;--i)kt(e,{from:a[i].from,to:a[i].to,text:[""]});a.length&&kt(e,{from:a[0].from,to:a[0].to,text:t.text},n)}else kt(e,t,n)}function kt(e,t,n){n=Tt(e,t,n),qn(e,t,n,e.cm?e.cm.curOp.id:0/0),It(e,t,n,sn(e,t));var a=[];xn(e,function(e,n){!n&&-1==fa(a,e.history)&&(Qn(e.history,t),a.push(e.history)),It(e,t,null,sn(e,t))})}function yt(e,t){var n=e.history,a=("undo"==t?n.done:n.undone).pop();if(a){n.dirtyCounter+="undo"==t?-1:1;var i={changes:[],anchorBefore:a.anchorAfter,headBefore:a.headAfter,anchorAfter:a.anchorBefore,headAfter:a.headBefore};for(("undo"==t?n.undone:n.done).push(i),n=a.changes.length-1;n>=0;--n){var o=a.changes[n];o.origin=t,i.changes.push(Vn(e,o));var r=n?Tt(e,o,null):{anchor:a.anchorBefore,head:a.headBefore};It(e,o,r,dn(e,o));var l=[];xn(e,function(e,t){!t&&-1==fa(l,e.history)&&(Qn(e.history,o),l.push(e.history)),It(e,o,null,dn(e,o))})}}}function Rt(e,t){function n(e){return St(e.line+t,e.ch)}e.first+=t,e.cm&&V(e.cm,e.first,e.first,t),e.sel.head=n(e.sel.head),e.sel.anchor=n(e.sel.anchor),e.sel.from=n(e.sel.from),e.sel.to=n(e.sel.to)}function It(e,t,n,a){if(e.cm&&!e.cm.curOp)return $(e.cm,It)(e,t,n,a);if(t.to.line<e.first)Rt(e,t.text.length-1-(t.to.line-t.from.line));else if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var i=t.text.length-1-(e.first-t.from.line);Rt(e,i),t={from:St(e.first,0),to:St(t.to.line+i,t.to.ch),text:[ha(t.text)],origin:t.origin}}i=e.lastLine(),t.to.line>i&&(t={from:t.from,to:St(i,Pn(e,i).text.length),text:[t.text[0]],origin:t.origin}),n||(n=Tt(e,t,null)),e.cm?Dt(e.cm,t,a,n):An(e,t,a,n)}}function Dt(e,t,n,i){var o=e.doc,r=e.display,l=t.from,d=t.to,c=!1,u=l.line;if(e.options.lineWrapping||(u=Mn(mn(o,Pn(o,l.line))),o.iter(u,d.line+1,function(e){return e==r.maxLine?c=!0:void 0})),An(o,t,n,i,a(e)),e.options.lineWrapping||(o.iter(u,l.line+t.text.length,function(e){var t=s(o,e);t>r.maxLineLength&&(r.maxLine=e,r.maxLineLength=t,r.maxLineChanged=!0,c=!1)}),c&&(e.curOp.updateMaxLine=!0)),o.frontier=Math.min(o.frontier,l.line),D(e,400),V(e,l.line,d.line+1,t.text.length-(d.line-l.line)-1),ca(e,"change"))if(t={from:l,to:d,text:t.text,origin:t.origin},e.curOp.textChanged){for(e=e.curOp.textChanged;e.next;e=e.next);e.next=t}else e.curOp.textChanged=t}function Ot(e,t,n,a,i){if(a||(a=n),_t(a,n))var o=a,a=n,n=o;"string"==typeof t&&(t=ji(t)),Ct(e,{from:n,to:a,text:t,origin:i},null)}function St(e,t){return this instanceof St?(this.line=e,void(this.ch=t)):new St(e,t)}function wt(e,t){return e.line==t.line&&e.ch==t.ch}function _t(e,t){return e.line<t.line||e.line==t.line&&e.ch<t.ch}function At(e){return St(e.line,e.ch)}function Kt(e,t){if(t.line<e.first)return St(e.first,0);var n=e.first+e.size-1;return t.line>n?St(n,Pn(e,n).text.length):Nt(t,Pn(e,t.line).text.length)}function Nt(e,t){var n=e.ch;return null==n||n>t?St(e.line,t):0>n?St(e.line,0):e}function xt(e,t){return t>=e.first&&t<e.first+e.size}function Lt(e,t,n,a){if(e.sel.shift||e.sel.extend){var i=e.sel.anchor;if(n){var o=_t(t,i);o!=_t(n,i)?(i=t,t=n):o!=_t(t,n)&&(t=n)}Pt(e,i,t,a)}else Pt(e,t,n||t,a);e.cm&&(e.cm.curOp.userSelChange=!0)}function Pt(e,t,n,a,i){(!i&&ca(e,"beforeSelectionChange")||e.cm&&ca(e.cm,"beforeSelectionChange"))&&(t={anchor:t,head:n},la(e,"beforeSelectionChange",e,t),e.cm&&la(e.cm,"beforeSelectionChange",e.cm,t),t.anchor=Kt(e,t.anchor),t.head=Kt(e,t.head),n=t.head,t=t.anchor);var o=e.sel;o.goalColumn=null,(i||!wt(t,o.anchor))&&(t=Ft(e,t,a,"push"!=i)),(i||!wt(n,o.head))&&(n=Ft(e,n,a,"push"!=i)),wt(o.anchor,t)&&wt(o.head,n)||(o.anchor=t,o.head=n,a=_t(n,t),o.from=a?n:t,o.to=a?t:n,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=!0),sa(e,"cursorActivity",e))}function Bt(e){Pt(e.doc,e.doc.sel.from,e.doc.sel.to,null,"push")}function Ft(e,t,n,a){var i=!1,o=t,r=n||1;e.cantEdit=!1;e:for(;;){var l,s=Pn(e,o.line);if(s.markedSpans){for(var d=0;d<s.markedSpans.length;++d){var c=s.markedSpans[d],u=c.marker;if((null==c.from||(u.inclusiveLeft?c.from<=o.ch:c.from<o.ch))&&(null==c.to||(u.inclusiveRight?c.to>=o.ch:c.to>o.ch)))if(a&&u.clearOnEnter)(l||(l=[])).push(u);else if(u.atomic){if(d=u.find()[0>r?"from":"to"],wt(d,o)&&(d.ch+=r,0>d.ch?d=d.line>e.first?Kt(e,St(d.line-1)):null:d.ch>s.text.length&&(d=d.line<e.first+e.size-1?St(d.line+1,0):null),!d)){if(i)return a?(e.cantEdit=!0,St(e.first,0)):Ft(e,t,n,!0);i=!0,d=t,r=-r}o=d;continue e}}if(l)for(d=0;d<l.length;++d)l[d].clear()}return o}}function zt(e,t){for(;;){var n=!1,a=L(e,t),i=jt(e,a.left,a.top,a.left,a.bottom),o=e.doc.scrollTop,r=e.doc.scrollLeft;if(null!=i.scrollTop&&(ot(e,i.scrollTop),1<Math.abs(e.doc.scrollTop-o)&&(n=!0)),null!=i.scrollLeft&&(rt(e,i.scrollLeft),1<Math.abs(e.doc.scrollLeft-r)&&(n=!0)),!n)return a}}function Mt(e,t,n,a,i){t=jt(e,t,n,a,i),null!=t.scrollTop&&ot(e,t.scrollTop),null!=t.scrollLeft&&rt(e,t.scrollLeft)}function jt(e,t,n,a,i){var o=e.display,r=o.lineSpace.offsetTop,n=n+r,i=i+r,l=o.scroller.clientHeight-Ki,s=o.scroller.scrollTop,d={},e=e.doc.height+2*r,c=r+10>n,r=i+r>e-10;return s>n?d.scrollTop=c?0:Math.max(0,n):i>s+l&&(d.scrollTop=(r?e:i)-l),n=o.scroller.clientWidth-Ki,i=o.scroller.scrollLeft,t+=o.gutters.offsetWidth,a+=o.gutters.offsetWidth,o=o.gutters.offsetWidth,l=o+10>t,i+o>t||l?(l&&(t=0),d.scrollLeft=Math.max(0,t-10-o)):a>n+i-3&&(d.scrollLeft=a+10-n),d}function Ht(e,t,n,a){var i=e.doc;if(n||(n="add"),"smart"==n)if(e.doc.mode.indent)var o=w(e,t);else n="prev";var r,l=e.options.tabSize,s=Pn(i,t),d=pa(s.text,null,l),c=s.text.match(/^\s*/)[0];if("smart"==n&&(r=e.doc.mode.indent(o,s.text.slice(c.length),s.text),r==Ni)){if(!a)return;n="prev"}if("prev"==n?r=t>i.first?pa(Pn(i,t-1).text,null,l):0:"add"==n?r=d+e.options.indentUnit:"subtract"==n&&(r=d-e.options.indentUnit),r=Math.max(0,r),n="",a=0,e.options.indentWithTabs)for(i=Math.floor(r/l);i;--i)a+=l,n+="	";r>a&&(n+=ma(r-a)),n!=c&&Ot(e.doc,n,St(t,0),St(t,c.length),"+input"),s.stateAfter=null}function $t(e,t,n){var a=t,i=t,o=e.doc;return"number"==typeof t?i=Pn(o,Math.max(o.first,Math.min(t,o.first+o.size-1))):a=Mn(t),null!=a&&n(i,a)?(V(e,a,a+1),i):null}function Ut(e,t,n,a,i){function o(t){var a=(i?La:Pa)(s,l,n,!0);if(null==a){if((t=!t)&&(t=r+n,t<e.first||t>=e.first+e.size?t=d=!1:(r=t,t=s=Pn(e,t))),!t)return d=!1;l=i?(0>n?Ka:Aa)(s):0>n?s.text.length:0}else l=a;return!0}var r=t.line,l=t.ch,s=Pn(e,r),d=!0;if("char"==a)o();else if("column"==a)o(!0);else if("word"==a)for(t=!1;!(0>n)||o();){if(Ea(s.text.charAt(l)))t=!0;else if(t){0>n&&(n=1,o());break}if(n>0&&!o())break}return t=Ft(e,St(r,l),n,!0),d||(t.hitSide=!0),t}function Wt(e,t,n,a){var i,o=e.doc,r=t.left;for("page"==a?(a=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),i=t.top+n*a):"line"==a&&(i=n>0?t.bottom+3:t.top-3);;){var l=B(e,r,i);if(!l.outside)break;if(0>n?0>=i:i>=o.height){l.hitSide=!0;break}i+=5*n}return l}function Vt(e,t){var n=t.ch,a=t.ch;if(e){!1===t.after||a==e.length?--n:++a;for(var i=e.charAt(n),i=Ea(i)?Ea:/\s/.test(i)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!Ea(e)};n>0&&i(e.charAt(n-1));)--n;for(;a<e.length&&i(e.charAt(a));)++a}return{from:St(t.line,n),to:St(t.line,a)}}function qt(e,t){Lt(e.doc,St(t,0),Kt(e.doc,St(t+1,0)))}function Gt(t,n,a,i){e.defaults[t]=n,a&&(hi[t]=i?function(e,t,n){n!=fi&&a(e,t,n)}:a)}function Yt(e,t){if(!0===t)return t;if(e.copyState)return e.copyState(t);var n,a={};for(n in t){var i=t[n];i instanceof Array&&(i=i.concat([])),a[n]=i}return a}function Xt(e,t,n){return e.startState?e.startState(t,n):!0}function Zt(e){return"string"==typeof e?ki[e]:e}function Qt(e,t,n){function a(t){var t=Zt(t),i=t[e];if(!1===i)return"stop";if(null!=i&&n(i))return!0;if(t.nofallthrough)return"stop";if(t=t.fallthrough,null==t)return!1;if("[object Array]"!=Object.prototype.toString.call(t))return a(t);for(var i=0,o=t.length;o>i;++i){var r=a(t[i]);if(r)return r}return!1}for(var i=0;i<t.length;++i){var o=a(t[i]);if(o)return o}}function Jt(e){return e=Ui[e.keyCode],"Ctrl"==e||"Alt"==e||"Shift"==e||"Mod"==e}function en(e,t){var n=Ui[e.keyCode];return null==n||e.altGraphKey?!1:(e.altKey&&(n="Alt-"+n),(ii?e.metaKey:e.ctrlKey)&&(n="Ctrl-"+n),(ii?e.ctrlKey:e.metaKey)&&(n="Cmd-"+n),!t&&e.shiftKey&&(n="Shift-"+n),n)}function tn(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8}function nn(e,t){this.lines=[],this.type=t,this.doc=e}function an(e,t,n,a,i){if(a&&a.shared)return rn(e,t,n,a,i);if(e.cm&&!e.cm.curOp)return $(e.cm,an)(e,t,n,a,i);var o=new nn(e,i);if("range"==i&&!_t(t,n))return o;a&&ba(a,o),o.replacedWith&&(o.collapsed=!0,o.replacedWith=ka("span",[o.replacedWith],"CodeMirror-widget")),o.collapsed&&(li=!0);var r,l,s,d=t.line,c=0,u=e.cm;if(e.iter(d,n.line+1,function(a){u&&o.collapsed&&!u.options.lineWrapping&&mn(e,a)==u.display.maxLine&&(s=!0);var i={from:null,to:null,marker:o};c+=a.text.length,d==t.line&&(i.from=t.ch,c-=t.ch),d==n.line&&(i.to=n.ch,c-=a.text.length-n.ch),o.collapsed&&(d==n.line&&(l=un(a,n.ch)),d==t.line?r=un(a,t.ch):zn(a,0)),a.markedSpans=a.markedSpans?a.markedSpans.concat([i]):[i],i.marker.attachLine(a),++d}),o.collapsed&&e.iter(t.line,n.line+1,function(t){hn(e,t)&&zn(t,0)}),o.readOnly&&(ri=!0,(e.history.done.length||e.history.undone.length)&&e.clearHistory()),o.collapsed){if(r!=l)throw Error("Inserting collapsed marker overlapping an existing one");o.size=c,o.atomic=!0}return u&&(s&&(u.curOp.updateMaxLine=!0),(o.className||o.startStyle||o.endStyle||o.collapsed)&&V(u,t.line,n.line+1),o.atomic&&Bt(u)),o}function on(e,t){this.markers=e,this.primary=t;for(var n=0,a=this;n<e.length;++n)e[n].parent=this,oa(e[n],"clear",function(){a.clear()})}function rn(e,t,n,a,i){a=ba(a),a.shared=!1;var o=[an(e,t,n,a,i)],r=o[0];return xn(e,function(e){o.push(an(e,Kt(e,t),Kt(e,n),a,i));for(var l=0;l<e.linked.length;++l)if(e.linked[l].isParent)return;r=ha(o)}),new on(o,r)}function ln(e,t){if(e)for(var n=0;n<e.length;++n){var a=e[n];if(a.marker==t)return a}}function sn(e,t){var n=xt(e,t.from.line)&&Pn(e,t.from.line).markedSpans,a=xt(e,t.to.line)&&Pn(e,t.to.line).markedSpans;if(!n&&!a)return null;var i=t.from.ch,o=t.to.ch,r=wt(t.from,t.to);if(n)for(var l,s=0;s<n.length;++s){var d=n[s],c=d.marker;if(null==d.from||(c.inclusiveLeft?d.from<=i:d.from<i)||"bookmark"==c.type&&d.from==i&&(!r||!d.marker.insertLeft)){var u=null==d.to||(c.inclusiveRight?d.to>=i:d.to>i);(l||(l=[])).push({from:d.from,to:u?null:d.to,marker:c})}}if(n=l,a)for(var p,s=0;s<a.length;++s)l=a[s],d=l.marker,(null==l.to||(d.inclusiveRight?l.to>=o:l.to>o)||"bookmark"==d.type&&l.from==o&&(!r||l.marker.insertLeft))&&(c=null==l.from||(d.inclusiveLeft?l.from<=o:l.from<o),(p||(p=[])).push({from:c?null:l.from-o,to:null==l.to?null:l.to-o,marker:d}));if(a=p,r=1==t.text.length,p=ha(t.text).length+(r?i:0),n)for(o=0;o<n.length;++o)s=n[o],null==s.to&&((l=ln(a,s.marker))?r&&(s.to=null==l.to?null:l.to+p):s.to=i);if(a)for(o=0;o<a.length;++o)s=a[o],null!=s.to&&(s.to+=p),null==s.from?(l=ln(n,s.marker),l||(s.from=p,r&&(n||(n=[])).push(s))):(s.from+=p,r&&(n||(n=[])).push(s));if(i=[n],!r){var m,r=t.text.length-2;if(r>0&&n)for(o=0;o<n.length;++o)null==n[o].to&&(m||(m=[])).push({from:null,to:null,marker:n[o].marker});for(o=0;r>o;++o)i.push(m);i.push(a)}return i}function dn(e,t){var n;if(n=t["spans_"+e.id]){for(var a=0,i=[];a<t.text.length;++a)i.push(Gn(n[a]));n=i}else n=null;if(a=sn(e,t),!n)return a;if(!a)return n;for(i=0;i<n.length;++i){var o=n[i],r=a[i];if(o&&r){var l=0;e:for(;l<r.length;++l){for(var s=r[l],d=0;d<o.length;++d)if(o[d].marker==s.marker)continue e;o.push(s)}}else r&&(n[i]=r)}return n}function cn(e,t,n){var a=null;if(e.iter(t.line,n.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var n=e.markedSpans[t].marker;!n.readOnly||a&&-1!=fa(a,n)||(a||(a=[])).push(n)}}),!a)return null;for(e=[{from:t,to:n}],t=0;t<a.length;++t)for(var n=a[t],i=n.find(),o=0;o<e.length;++o){var r=e[o];if(!_t(r.to,i.from)&&!_t(i.to,r.from)){var l=[o,1];(_t(r.from,i.from)||!n.inclusiveLeft&&wt(r.from,i.from))&&l.push({from:r.from,to:i.from}),(_t(i.to,r.to)||!n.inclusiveRight&&wt(r.to,i.to))&&l.push({from:i.to,to:r.to}),e.splice.apply(e,l),o+=l.length-1}}return e}function un(e,t){var n,a=li&&e.markedSpans;if(a)for(var i,o=0;o<a.length;++o)i=a[o],i.marker.collapsed&&(null==i.from||i.from<t)&&(null==i.to||i.to>t)&&(!n||n.width<i.marker.width)&&(n=i.marker);return n}function pn(e){return un(e,e.text.length+1)}function mn(e,t){for(var n;n=un(t,-1);)t=Pn(e,n.find().from.line);return t}function hn(e,t){var n=li&&t.markedSpans;if(n)for(var a,i=0;i<n.length;++i)if(a=n[i],a.marker.collapsed&&(null==a.from||0==a.from&&a.marker.inclusiveLeft&&gn(e,t,a)))return!0}function gn(e,t,n){if(null==n.to)return t=n.marker.find().to,t=Pn(e,t.line),gn(e,t,ln(t.markedSpans,n.marker));if(n.marker.inclusiveRight&&n.to==t.text.length)return!0;for(var a,i=0;i<t.markedSpans.length;++i)if(a=t.markedSpans[i],a.marker.collapsed&&a.from==n.to&&(a.marker.inclusiveLeft||n.marker.inclusiveRight)&&gn(e,t,a))return!0}function fn(e){var t=e.markedSpans;if(t){for(var n=0;n<t.length;++n)t[n].marker.detachLine(e);e.markedSpans=null}}function bn(e,t){if(t){for(var n=0;n<t.length;++n)t[n].marker.attachLine(e);e.markedSpans=t}}function vn(e){return function(){var t=!this.cm.curOp;t&&j(this.cm);try{var n=e.apply(this,arguments)}finally{t&&H(this.cm)}return n}}function Tn(e){return null!=e.height?e.height:((!e.node.parentNode||1!=e.node.parentNode.nodeType)&&Ra(e.cm.display.measure,ka("div",[e.node],null,"position: relative")),e.height=e.node.offsetHeight)}function En(e,t,n,a){var i=new yi(e,n,a);return i.noHScroll&&(e.display.alignWidgets=!0),$t(e,t,function(t){if((t.widgets||(t.widgets=[])).push(i),i.line=t,!hn(e.doc,t)||i.showIfHidden){var n=Hn(e,t)<e.display.scroller.scrollTop;zn(t,t.height+Tn(i)),n&&(e.curOp.updateScrollPos={scrollTop:e.doc.scrollTop+i.height,scrollLeft:e.doc.scrollLeft})}return!0}),i}function Cn(e,t,n){return e={text:e},bn(e,t),e.height=n?n(e):1,e}function kn(e,t,n,a){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),fn(e),bn(e,n),t=a?a(e):1,t!=e.height&&zn(e,t),sa(e,"change")}function yn(e,t,n,a,i){var o=e.options.flattenSpans,r="",l=null,e=new tn(t,e.options.tabSize);for(""==t&&n.blankLine&&n.blankLine(a);!e.eol();){var s=n.token(e,a);5e3<e.pos&&(o=!1,e.pos=Math.min(t.length,e.start+5e4),s=null);var d=e.current();e.start=e.pos,o&&l==s?r+=d:(r&&i(r,l),r=d,l=s)}r&&i(r,l)}function Rn(e,t,n){var a=[e.state.modeGen];for(yn(e,t.text,e.doc.mode,n,function(e,t){a.push(e,t)}),n=0;n<e.state.overlays.length;++n){var i=e.state.overlays[n],o=1;yn(e,t.text,i.mode,!0,function(e,t){for(var n=o,r=e.length;r;){var l=a[o],s=l.length;r>=s?r-=s:(a.splice(o,1,l.slice(0,r),a[o+1],l.slice(r)),r=0),o+=2}if(t)if(i.opaque)a.splice(n,o-n,e,t),o=n+2;else for(;o>n;n+=2)l=a[n+1],a[n+1]=l?l+" "+t:t})}return a}function In(e,t,n){var a=e.doc.mode,e=new tn(t.text,e.options.tabSize);for(""==t.text&&a.blankLine&&a.blankLine(n);!e.eol()&&5e3>=e.pos;)a.token(e,n),e.start=e.pos}function Dn(e){return e?Ri[e]||(Ri[e]="cm-"+e.replace(/ +/g," cm-")):null}function On(e,t,n){for(var a,i,o,r=t,l=!0;a=un(r,-1);)l=!1,r=Pn(e.doc,a.find().from.line),i||(i=r);a={pre:ka("pre"),col:0,pos:0,display:!n,measure:null,addedOne:!1,cm:e},r.textClass&&(a.pre.className=r.textClass);do{a.measure=r==t&&n,a.pos=0,a.addToken=a.measure?wn:Sn,n&&o&&r!=t&&!a.addedOne&&(n[0]=a.pre.appendChild(Sa(e.display.measure)),a.addedOne=!0);var s=r;o=a;var d=r;d.styles&&d.styles[0]==e.state.modeGen||(d.styles=Rn(e,d,d.stateAfter=w(e,Mn(d))));e:{var c=s,d=d.styles;if(s=c.markedSpans)for(var c=c.text.length,u=0,p=1,m="",h=void 0,g=0,f=void 0,b=void 0,v=void 0,T=void 0;;){if(g==u){for(var f=b=v="",T=null,g=1/0,E=null,C=0;C<s.length;++C){var k=s[C],y=k.marker;k.from<=u&&(null==k.to||k.to>u)?(null!=k.to&&g>k.to&&(g=k.to,b=""),y.className&&(f+=" "+y.className),y.startStyle&&k.from==u&&(v+=" "+y.startStyle),y.endStyle&&k.to==g&&(b+=" "+y.endStyle),y.collapsed&&(!T||T.marker.width<y.width)&&(T=k)):k.from>u&&g>k.from&&(g=k.from),"bookmark"==y.type&&k.from==u&&y.replacedWith&&(E=y.replacedWith)}if(T&&(T.from||0)==u&&(_n(o,(null==T.to?c:T.to)-u,null!=T.from&&T.marker.replacedWith),null==T.to)){d=T.marker.find();break e}E&&!T&&_n(o,0,E)}if(u>=c)break;for(E=Math.min(c,g);;){if(m){if(C=u+m.length,T||(k=C>E?m.slice(0,E-u):m,o.addToken(o,k,h?h+f:f,v,u+k.length==g?b:"")),C>=E){m=m.slice(E-u),u=E;break}u=C,v=""}m=d[p++],h=Dn(d[p++])}}else for(var p=1;p<d.length;p+=2)o.addToken(o,d[p],Dn(d[p+1]));d=void 0}o=r==i,d&&(r=Pn(e.doc,d.to.line),l=!1)}while(d);n&&!a.addedOne&&(n[0]=a.pre.appendChild(l?ka("span","\xa0"):Sa(e.display.measure))),!a.pre.firstChild&&!hn(e.doc,t)&&a.pre.appendChild(document.createTextNode("\xa0"));var R;return n&&Fa&&(R=$n(r))&&(r=R.length-1,R[r].from==R[r].to&&--r,t=R[r],R=R[r-1],t.from+1==t.to&&R&&t.level<R.level&&(n=n[a.pos-1])&&n.parentNode.insertBefore(n.measureRight=Sa(e.display.measure),n.nextSibling)),a.pre}function Sn(e,t,n,a,i){if(t){if(Ii.test(t))for(var o=document.createDocumentFragment(),r=0;;){Ii.lastIndex=r;var l=Ii.exec(t),s=l?l.index-r:t.length-r;if(s&&(o.appendChild(document.createTextNode(t.slice(r,r+s))),e.col+=s),!l)break;r+=s+1,"	"==l[0]?(l=e.cm.options.tabSize,l-=e.col%l,o.appendChild(ka("span",ma(l),"cm-tab")),e.col+=l):(s=ka("span","\u2022","cm-invalidchar"),s.title="\\u"+l[0].charCodeAt(0).toString(16),o.appendChild(s),e.col+=1)}else{e.col+=t.length;var o=document.createTextNode(t)}if(n||a||i||e.measure)return t=n||"",a&&(t+=a),i&&(t+=i),e.pre.appendChild(ka("span",[o],t));e.pre.appendChild(o)}}function wn(e,t,n,a,i){for(var o=0;o<t.length;++o){var r=t.charAt(o),l=0==o;r>="\ud800"&&"\udbff">r&&o<t.length-1?(r=t.slice(o,o+2),++o):o&&e.cm.options.lineWrapping&&Fi.test(t.slice(o-1,o+1))&&e.pre.appendChild(ka("wbr")),e.measure[e.pos]=Sn(e,r,n,l&&a,o==t.length-1&&i),e.pos+=r.length}t.length&&(e.addedOne=!0)}function _n(e,t,n){n&&(e.display||(n=n.cloneNode(!0)),e.pre.appendChild(n),e.measure&&t&&(e.measure[e.pos]=n,e.addedOne=!0)),e.pos+=t}function An(e,t,n,a,i){function o(e){return n?n[e]:null}var r=t.from,l=t.to,s=t.text,d=Pn(e,r.line),c=Pn(e,l.line),u=ha(s),p=o(s.length-1),m=l.line-r.line;if(0==r.ch&&0==l.ch&&""==u){for(var h=0,g=s.length-1,f=[];g>h;++h)f.push(Cn(s[h],o(h),i));kn(c,c.text,p,i),m&&e.remove(r.line,m),f.length&&e.insert(r.line,f)}else if(d==c)if(1==s.length)kn(d,d.text.slice(0,r.ch)+u+d.text.slice(l.ch),p,i);else{for(f=[],h=1,g=s.length-1;g>h;++h)f.push(Cn(s[h],o(h),i));f.push(Cn(u+d.text.slice(l.ch),p,i)),kn(d,d.text.slice(0,r.ch)+s[0],o(0),i),e.insert(r.line+1,f)}else if(1==s.length)kn(d,d.text.slice(0,r.ch)+s[0]+c.text.slice(l.ch),o(0),i),e.remove(r.line+1,m);else{for(kn(d,d.text.slice(0,r.ch)+s[0],o(0),i),kn(c,u+c.text.slice(l.ch),p,i),h=1,g=s.length-1,f=[];g>h;++h)f.push(Cn(s[h],o(h),i));m>1&&e.remove(r.line+1,m-1),e.insert(r.line+1,f)}sa(e,"change",e,t),Pt(e,a.anchor,a.head,null,!0)}function Kn(e){this.lines=e,this.parent=null;for(var t=0,n=e.length,a=0;n>t;++t)e[t].parent=this,a+=e[t].height;this.height=a}function Nn(e){this.children=e;for(var t=0,n=0,a=0,i=e.length;i>a;++a){var o=e[a],t=t+o.chunkSize(),n=n+o.height;o.parent=this}this.size=t,this.height=n,this.parent=null}function xn(e,t,n){function a(e,i,o){if(e.linked)for(var r=0;r<e.linked.length;++r){var l=e.linked[r];if(l.doc!=i){var s=o&&l.sharedHist;(!n||s)&&(t(l.doc,s),a(l.doc,e,s))}}}a(e,null,!0)}function Ln(e,t){if(t.cm)throw Error("This document is already in use.");e.doc=t,t.cm=e,i(e),n(e),e.options.lineWrapping||d(e),e.options.mode=t.modeOption,V(e)}function Pn(e,t){for(t-=e.first;!e.lines;)for(var n=0;;++n){var a=e.children[n],i=a.chunkSize();if(i>t){e=a;break}t-=i}return e.lines[t]}function Bn(e,t,n){var a=[],i=t.line;return e.iter(t.line,n.line+1,function(e){e=e.text,i==n.line&&(e=e.slice(0,n.ch)),i==t.line&&(e=e.slice(t.ch)),a.push(e),++i}),a}function Fn(e,t,n){var a=[];return e.iter(t,n,function(e){a.push(e.text)}),a}function zn(e,t){for(var n=t-e.height,a=e;a;a=a.parent)a.height+=n}function Mn(e){if(null==e.parent)return null;for(var t=e.parent,e=fa(t.lines,e),n=t.parent;n;t=n,n=n.parent)for(var a=0;n.children[a]!=t;++a)e+=n.children[a].chunkSize();return e+t.first}function jn(e,t){var n=e.first;e:do{for(var a=0,i=e.children.length;i>a;++a){var o=e.children[a],r=o.height;if(r>t){e=o;continue e}t-=r,n+=o.chunkSize()}return n}while(!e.lines);for(a=0,i=e.lines.length;i>a&&(o=e.lines[a].height,!(o>t));++a)t-=o;return n+a}function Hn(e,t){for(var t=mn(e.doc,t),n=0,a=t.parent,i=0;i<a.lines.length;++i){var o=a.lines[i];if(o==t)break;n+=o.height}for(o=a.parent;o;a=o,o=a.parent)for(i=0;i<o.children.length;++i){var r=o.children[i];if(r==a)break;n+=r.height}return n}function $n(e){var t=e.order;return null==t&&(t=e.order=Wi(e.text)),t}function Un(){return{done:[],undone:[],undoDepth:1/0,lastTime:0,lastOp:null,lastOrigin:null,dirtyCounter:0}}function Wn(e,t,n,a){var i=t["spans_"+e.id],o=0;e.iter(Math.max(e.first,n),Math.min(e.first+e.size,a),function(n){n.markedSpans&&((i||(i=t["spans_"+e.id]={}))[o]=n.markedSpans),++o})}function Vn(e,t){var n={from:t.from,to:bt(t),text:Bn(e,t.from,t.to)};return Wn(e,n,t.from.line,t.to.line+1),xn(e,function(e){Wn(e,n,t.from.line,t.to.line+1)},!0),n}function qn(e,t,n,a){var i=e.history;i.undone.length=0;var o=+new Date,r=ha(i.done);if(r&&(i.lastOp==a||i.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&i.lastTime>o-600||"*"==t.origin.charAt(0)))){var l=ha(r.changes);wt(t.from,t.to)&&wt(t.from,l.to)?l.to=bt(t):r.changes.push(Vn(e,t)),r.anchorAfter=n.anchor,r.headAfter=n.head}else{for(r={changes:[Vn(e,t)],anchorBefore:e.sel.anchor,headBefore:e.sel.head,anchorAfter:n.anchor,headAfter:n.head},i.done.push(r);i.done.length>i.undoDepth;)i.done.shift();0>i.dirtyCounter?i.dirtyCounter=0/0:i.dirtyCounter++}i.lastTime=o,i.lastOp=a,i.lastOrigin=t.origin}function Gn(e){if(!e)return null;for(var t,n=0;n<e.length;++n)e[n].marker.explicitlyCleared?t||(t=e.slice(0,n)):t&&t.push(e[n]);return t?t.length?t:null:e}function Yn(e,t){for(var n=0,a=[];n<e.length;++n){var i=e[n],o=i.changes,r=[];for(a.push({changes:r,anchorBefore:i.anchorBefore,headBefore:i.headBefore,anchorAfter:i.anchorAfter,headAfter:i.headAfter}),i=0;i<o.length;++i){var l,s=o[i];if(r.push({from:s.from,to:s.to,text:s.text}),t)for(var d in s)(l=d.match(/^spans_(\d+)$/))&&-1<fa(t,Number(l[1]))&&(ha(r)[d]=s[d],delete s[d])}}return a}function Xn(e,t,n,a){n<e.line?e.line+=a:t<e.line&&(e.line=t,e.ch=0)}function Zn(e,t,n,a){for(var i=0;i<e.length;++i){for(var o=e[i],r=!0,l=0;l<o.changes.length;++l){var s=o.changes[l];if(o.copied||(s.from=At(s.from),s.to=At(s.to)),n<s.from.line)s.from.line+=a,s.to.line+=a;else if(t<=s.to.line){r=!1;break}}o.copied||(o.anchorBefore=At(o.anchorBefore),o.headBefore=At(o.headBefore),o.anchorAfter=At(o.anchorAfter),o.readAfter=At(o.headAfter),o.copied=!0),r?(Xn(o.anchorBefore),Xn(o.headBefore),Xn(o.anchorAfter),Xn(o.headAfter)):(e.splice(0,i+1),i=0)}}function Qn(e,t){var n=t.from.line,a=t.to.line,i=t.text.length-(a-n)-1;Zn(e.done,n,a,i),Zn(e.undone,n,a,i)}function Jn(){aa(this)}function ea(e){return e.stop||(e.stop=Jn),e}function ta(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function na(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function aa(e){ta(e),na(e)}function ia(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),Qa&&e.ctrlKey&&1==t&&(t=3),t}function oa(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):(e=e._handlers||(e._handlers={}),(e[t]||(e[t]=[])).push(n))}function ra(e,t,n){if(e.removeEventListener)e.removeEventListener(t,n,!1);else if(e.detachEvent)e.detachEvent("on"+t,n);else if(e=e._handlers&&e._handlers[t])for(t=0;t<e.length;++t)if(e[t]==n){e.splice(t,1);break}}function la(e,t){var n=e._handlers&&e._handlers[t];if(n)for(var a=Array.prototype.slice.call(arguments,2),i=0;i<n.length;++i)n[i].apply(null,a)}function sa(e,t){function n(e){return function(){e.apply(null,i)}}var a=e._handlers&&e._handlers[t];if(a){var i=Array.prototype.slice.call(arguments,2);_i||(++Ai,_i=[],setTimeout(da,0));for(var o=0;o<a.length;++o)_i.push(n(a[o]))}}function da(){--Ai;var e=_i;_i=null;for(var t=0;t<e.length;++t)e[t]()}function ca(e,t){var n=e._handlers&&e._handlers[t];return n&&0<n.length}function ua(){this.id=null}function pa(e,t,n){null==t&&(t=e.search(/[^\s\u00a0]/),-1==t&&(t=e.length));for(var a=0,i=0;t>a;++a)"	"==e.charAt(a)?i+=n-i%n:++i;return i}function ma(e){for(;xi.length<=e;)xi.push(ha(xi)+" ");return xi[e]}function ha(e){return e[e.length-1]}function ga(e){Xa?(e.selectionStart=0,e.selectionEnd=e.value.length):e.select()}function fa(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,a=e.length;a>n;++n)if(e[n]==t)return n;return-1}function ba(e,t){t||(t={});for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function va(e){for(var t=[],n=0;e>n;++n)t.push(void 0);return t}function Ta(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function Ea(e){return/\w/.test(e)||e>"\x80"&&(e.toUpperCase()!=e.toLowerCase()||Li.test(e))}function Ca(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}function ka(e,t,n,a){if(e=document.createElement(e),n&&(e.className=n),a&&(e.style.cssText=a),"string"==typeof t)Ia(e,t);else if(t)for(n=0;n<t.length;++n)e.appendChild(t[n]);return e}function ya(e){if(Fa)for(;e.firstChild;)e.removeChild(e.firstChild);else e.innerHTML="";return e}function Ra(e,t){return ya(e).appendChild(t)}function Ia(e,t){Ma?(e.innerHTML="",e.appendChild(document.createTextNode(t))):e.textContent=t}function Da(e){return e.getBoundingClientRect()}function Oa(e){if(null!=zi)return zi;var t=ka("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");return Ra(e,t),t.offsetWidth&&(zi=t.offsetHeight-t.clientHeight),zi||0}function Sa(e){if(null==Mi){var t=ka("span","\u200b");Ra(e,ka("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(Mi=1>=t.offsetWidth&&2<t.offsetHeight&&!za)}return Mi?ka("span","\u200b"):ka("span","\xa0",null,"display: inline-block; width: 1px; margin-right: -1px")}function wa(e,t,n,a){if(!e)return a(t,n,"ltr");for(var i=0;i<e.length;++i){var o=e[i];(o.from<n&&o.to>t||t==n&&o.to==t)&&a(Math.max(o.from,t),Math.min(o.to,n),1==o.level?"rtl":"ltr")}}function _a(e){return e.level%2?e.from:e.to}function Aa(e){return(e=$n(e))?e[0].level%2?e[0].to:e[0].from:0}function Ka(e){var t=$n(e);return t?_a(ha(t)):e.text.length}function Na(e,t){var n=Pn(e.doc,t),a=mn(e.doc,n);return a!=n&&(t=Mn(a)),n=$n(a),a=n?n[0].level%2?Ka(a):Aa(a):0,St(t,a)}function xa(e,t){for(var n,a;n=pn(a=Pn(e.doc,t));)t=n.find().to.line;return n=$n(a),a=n?n[0].level%2?Aa(a):Ka(a):a.text.length,St(t,a)}function La(e,t,n,a){var i=$n(e);if(!i)return Pa(e,t,n,a);for(var a=a?function(t,n){do t+=n;while(t>0&&Pi.test(e.text.charAt(t)));return t}:function(e,t){return e+t},o=i[0].level,r=0;r<i.length;++r){var l=i[r],s=l.level%2==o;if(l.from<t&&l.to>t||s&&(l.from==t||l.to==t))break}for(t=a(t,l.level%2?-n:n);null!=t;)if(l.level%2==o){if(!(t<l.from||t>l.to))break;t=(l=i[r+=n])&&(n>0==l.level%2?a(l.to,-1):a(l.from,1))}else if(t==(l.level%2?l.to:l.from))t=(l=i[--r])&&_a(l);else{if(t!=_a(l))break;t=(l=i[++r])&&(l.level%2?l.to:l.from)}return 0>t||t>e.text.length?null:t}function Pa(e,t,n,a){if(t+=n,a)for(;t>0&&Pi.test(e.text.charAt(t));)t+=n;return 0>t||t>e.text.length?null:t}var Ba=/gecko\/\d/i.test(navigator.userAgent),Fa=/MSIE \d/.test(navigator.userAgent),za=Fa&&(null==document.documentMode||8>document.documentMode),Ma=Fa&&(null==document.documentMode||9>document.documentMode),ja=/WebKit\//.test(navigator.userAgent),Ha=ja&&/Qt\/\d+\.\d+/.test(navigator.userAgent),$a=/Chrome\//.test(navigator.userAgent),Ua=/Opera\//.test(navigator.userAgent),Wa=/Apple Computer/.test(navigator.vendor),Va=/KHTML\//.test(navigator.userAgent),qa=/Mac OS X 1\d\D([7-9]|\d\d)\D/.test(navigator.userAgent),Ga=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),Ya=/PhantomJS/.test(navigator.userAgent),Xa=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),Za=Xa||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent),Qa=Xa||/Mac/.test(navigator.platform),Ja=/windows/i.test(navigator.platform),ei=Ua&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);ei&&(ei=Number(ei[1]));var ti,ni,ai,ii=Qa&&(Ha||Ua&&(null==ei||12.11>ei)),oi=Ba||Fa&&!Ma,ri=!1,li=!1,si=0,di=0,ci=null;Fa?ci=-.53:Ba?ci=15:$a?ci=-.7:Wa&&(ci=-1/3);var ui,pi,mi=null;e.Pos=St,e.prototype={focus:function(){window.focus(),Z(this),ht(this),G(this)},setOption:function(e,t){var n=this.options,a=n[e];n[e]==t&&"mode"!=e||(n[e]=t,hi.hasOwnProperty(e)&&$(this,hi[e])(this,t,a))},getOption:function(e){return this.options[e]
},getDoc:function(){return this.doc},addKeyMap:function(e){this.state.keyMaps.push(e)},removeKeyMap:function(e){for(var t=this.state.keyMaps,n=0;n<t.length;++n)if(("string"==typeof e?t[n].name:t[n])==e)return t.splice(n,1),!0},addOverlay:$(null,function(t,n){var a=t.token?t:e.getMode(this.options,t);if(a.startState)throw Error("Overlays may not be stateful.");this.state.overlays.push({mode:a,modeSpec:t,opaque:n&&n.opaque}),this.state.modeGen++,V(this)}),removeOverlay:$(null,function(e){for(var t=this.state.overlays,n=0;n<t.length;++n)if(t[n].modeSpec==e){t.splice(n,1),this.state.modeGen++,V(this);break}}),indentLine:$(null,function(e,t,n){"string"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),xt(this.doc,e)&&Ht(this,e,t,n)}),indentSelection:$(null,function(e){var t=this.doc.sel;if(wt(t.from,t.to))return Ht(this,t.from.line,e);for(var n=t.to.line-(t.to.ch?0:1),t=t.from.line;n>=t;++t)Ht(this,t,e)}),getTokenAt:function(e){for(var t=this.doc,e=Kt(t,e),n=w(this,e.line),a=this.doc.mode,t=Pn(t,e.line),t=new tn(t.text,this.options.tabSize);t.pos<e.ch&&!t.eol();){t.start=t.pos;var i=a.token(t,n)}return{start:t.start,end:t.pos,string:t.current(),className:i||null,type:i||null,state:n}},getStateAfter:function(e){var t=this.doc,e=Math.max(t.first,Math.min(null==e?t.first+t.size-1:e,t.first+t.size-1));return w(this,e+1)},cursorCoords:function(e,t){var n;return n=this.doc.sel,n=null==e?n.head:"object"==typeof e?Kt(this.doc,e):e?n.from:n.to,L(this,n,t||"page")},charCoords:function(e,t){return x(this,Kt(this.doc,e),t||"page")},coordsChar:function(e){var t=Da(this.display.lineSpace);return B(this,e.left-t.left-(window.pageXOffset||(document.documentElement||document.body).scrollLeft),e.top-t.top-(window.pageYOffset||(document.documentElement||document.body).scrollTop))},defaultTextHeight:function(){return z(this.display)},setGutterMarker:$(null,function(e,t,n){return $t(this,e,function(e){var a=e.gutterMarkers||(e.gutterMarkers={});return a[t]=n,!n&&Ca(a)&&(e.gutterMarkers=null),!0})}),clearGutter:$(null,function(e){var t=this,n=t.doc,a=n.first;n.iter(function(n){n.gutterMarkers&&n.gutterMarkers[e]&&(n.gutterMarkers[e]=null,V(t,a,a+1),Ca(n.gutterMarkers)&&(n.gutterMarkers=null)),++a})}),addLineClass:$(null,function(e,t,n){return $t(this,e,function(e){var a="text"==t?"textClass":"background"==t?"bgClass":"wrapClass";if(e[a]){if(RegExp("\\b"+n+"\\b").test(e[a]))return!1;e[a]+=" "+n}else e[a]=n;return!0})}),removeLineClass:$(null,function(e,t,n){return $t(this,e,function(e){var a="text"==t?"textClass":"background"==t?"bgClass":"wrapClass",i=e[a];if(!i)return!1;if(null==n)e[a]=null;else{var o=i.replace(RegExp("^"+n+"\\b\\s*|\\s*\\b"+n+"\\b"),"");if(o==i)return!1;e[a]=o||null}return!0})}),addLineWidget:$(null,function(e,t,n){return En(this,e,t,n)}),removeLineWidget:function(e){e.clear()},lineInfo:function(e){if("number"==typeof e){if(!xt(this.doc,e))return null;var t=e,e=Pn(this.doc,e);if(!e)return null}else if(t=Mn(e),null==t)return null;return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},getViewport:function(){return{from:this.display.showingFrom,to:this.display.showingTo}},addWidget:function(e,t,n,a,i){var o=this.display,e=L(this,Kt(this.doc,e)),r=e.bottom,l=e.left;if(t.style.position="absolute",o.sizer.appendChild(t),"over"==a)r=e.top;else if("above"==a||"near"==a){var s=Math.max(o.wrapper.clientHeight,this.doc.height),d=Math.max(o.sizer.clientWidth,o.lineSpace.clientWidth);("above"==a||e.bottom+t.offsetHeight>s)&&e.top>t.offsetHeight?r=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=s&&(r=e.bottom),l+t.offsetWidth>d&&(l=d-t.offsetWidth)}t.style.top=r+o.lineSpace.offsetTop+"px",t.style.left=t.style.right="","right"==i?(l=o.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==i?l=0:"middle"==i&&(l=(o.sizer.clientWidth-t.offsetWidth)/2),t.style.left=l+"px"),n&&Mt(this,l,r,l+t.offsetWidth,r+t.offsetHeight)},triggerOnKeyDown:$(null,pt),execCommand:function(e){return Ci[e](this)},findPosH:function(e,t,n,a){var i=1;0>t&&(i=-1,t=-t);for(var o=0,e=Kt(this.doc,e);t>o&&(e=Ut(this.doc,e,i,n,a),!e.hitSide);++o);return e},moveH:$(null,function(e,t){var n=this.doc.sel,n=n.shift||n.extend||wt(n.from,n.to)?Ut(this.doc,n.head,e,t,this.options.rtlMoveVisually):0>e?n.from:n.to;Lt(this.doc,n,n,e)}),deleteH:$(null,function(e,t){var n=this.doc.sel;wt(n.from,n.to)?Ot(this.doc,"",n.from,Ut(this.doc,n.head,e,t,!1),"+delete"):Ot(this.doc,"",n.from,n.to,"+delete"),this.curOp.userSelChange=!0}),findPosV:function(e,t,n,a){var i=1;0>t&&(i=-1,t=-t);for(var o=0,e=Kt(this.doc,e);t>o&&(e=L(this,e,"div"),null==a?a=e.left:e.left=a,e=Wt(this,e,i,n),!e.hitSide);++o);return e},moveV:$(null,function(e,t){var n=this.doc.sel,a=L(this,n.head,"div");null!=n.goalColumn&&(a.left=n.goalColumn);var i=Wt(this,a,e,t);"page"==t&&(this.display.scrollbarV.scrollTop+=x(this,i,"div").top-a.top),Lt(this.doc,i,i,e),n.goalColumn=a.left}),toggleOverwrite:function(){this.display.cursor.className=(this.state.overwrite=!this.state.overwrite)?this.display.cursor.className+" CodeMirror-overwrite":this.display.cursor.className.replace(" CodeMirror-overwrite","")},scrollTo:$(null,function(e,t){this.curOp.updateScrollPos={scrollLeft:e,scrollTop:t}}),getScrollInfo:function(){var e=this.display.scroller,t=Ki;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-t,width:e.scrollWidth-t,clientHeight:e.clientHeight-t,clientWidth:e.clientWidth-t}},scrollIntoView:function(e){"number"==typeof e&&(e=St(e,0)),e&&null==e.line?Mt(this,e.left,e.top,e.right,e.bottom):(e=e?Kt(this.doc,e):this.doc.sel.head,zt(this,e))},setSize:function(e,t){function n(e){return"number"==typeof e||/^\d+$/.test(""+e)?e+"px":e}null!=e&&(this.display.wrapper.style.width=n(e)),null!=t&&(this.display.wrapper.style.height=n(t)),this.refresh()},on:function(e,t){oa(this,e,t)},off:function(e,t){ra(this,e,t)},operation:function(e){return W(this,e)},refresh:$(null,function(){K(this),this.curOp.updateScrollPos={scrollTop:this.doc.scrollTop,scrollLeft:this.doc.scrollLeft},V(this)}),swapDoc:$(null,function(e){var t=this.doc;return t.cm=null,Ln(this,e),K(this),this.curOp.updateScrollPos={scrollTop:e.scrollTop,scrollLeft:e.scrollLeft},t}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};var hi=e.optionHandlers={},gi=e.defaults={},fi=e.Init={toString:function(){return"CodeMirror.Init"}};Gt("value","",function(e,t){e.setValue(t)},!0),Gt("mode",null,function(e,t){e.doc.modeOption=t,n(e)},!0),Gt("indentUnit",2,n,!0),Gt("indentWithTabs",!1),Gt("smartIndent",!0),Gt("tabSize",4,function(e){n(e),K(e),V(e)},!0),Gt("electricChars",!0),Gt("rtlMoveVisually",!Ja),Gt("theme","default",function(e){o(e),r(e)},!0),Gt("keyMap","default",function(e){var t=ki[e.options.keyMap].style;e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(t?" cm-keymap-"+t:"")}),Gt("extraKeys",null),Gt("onKeyEvent",null),Gt("onDragEvent",null),Gt("lineWrapping",!1,function(e){e.options.lineWrapping?(e.display.wrapper.className=e.display.wrapper.className+" CodeMirror-wrap",e.display.sizer.style.minWidth=""):(e.display.wrapper.className=e.display.wrapper.className.replace(" CodeMirror-wrap",""),d(e)),i(e),V(e),K(e),setTimeout(function(){u(e.display,e.doc.height)},100)},!0),Gt("gutters",[],function(e){c(e.options),r(e)},!0),Gt("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?g(e.display)+"px":"0",e.refresh()},!0),Gt("lineNumbers",!1,function(e){c(e.options),r(e)},!0),Gt("firstLineNumber",1,r,!0),Gt("lineNumberFormatter",function(e){return e},r,!0),Gt("showCursorWhenSelecting",!1,y,!0),Gt("readOnly",!1,function(e,t){"nocursor"==t?(gt(e),e.display.input.blur()):t||X(e,!0)}),Gt("dragDrop",!0),Gt("cursorBlinkRate",530),Gt("cursorHeight",1),Gt("workTime",100),Gt("workDelay",100),Gt("flattenSpans",!0),Gt("pollInterval",100),Gt("undoDepth",40,function(e,t){e.doc.history.undoDepth=t}),Gt("viewportMargin",10,function(e){e.refresh()},!0),Gt("tabindex",null,function(e,t){e.display.input.tabIndex=t||""}),Gt("autofocus",null);var bi=e.modes={},vi=e.mimeModes={};e.defineMode=function(t,n){if(!e.defaults.mode&&"null"!=t&&(e.defaults.mode=t),2<arguments.length){n.dependencies=[];for(var a=2;a<arguments.length;++a)n.dependencies.push(arguments[a])}bi[t]=n},e.defineMIME=function(e,t){vi[e]=t},e.resolveMode=function(t){if("string"==typeof t&&vi.hasOwnProperty(t))t=vi[t];else if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return e.resolveMode("application/xml");return"string"==typeof t?{name:t}:t||{name:"null"}},e.getMode=function(t,n){var n=e.resolveMode(n),a=bi[n.name];if(!a)return e.getMode(t,"text/plain");if(a=a(t,n),Ti.hasOwnProperty(n.name)){var i,o=Ti[n.name];for(i in o)o.hasOwnProperty(i)&&(a.hasOwnProperty(i)&&(a["_"+i]=a[i]),a[i]=o[i])}return a.name=n.name,a},e.defineMode("null",function(){return{token:function(e){e.skipToEnd()}}}),e.defineMIME("text/plain","null");var Ti=e.modeExtensions={};e.extendMode=function(e,t){var n=Ti.hasOwnProperty(e)?Ti[e]:Ti[e]={};ba(t,n)},e.defineExtension=function(t,n){e.prototype[t]=n},e.defineOption=Gt;var Ei=[];e.defineInitHook=function(e){Ei.push(e)},e.copyState=Yt,e.startState=Xt,e.innerMode=function(e,t){for(;e.innerMode;)var n=e.innerMode(t),t=n.state,e=n.mode;return n||{mode:e,state:t}};var Ci=e.commands={selectAll:function(e){e.setSelection(St(e.firstLine(),0),St(e.lastLine()))},killLine:function(e){var t=e.getCursor(!0),n=e.getCursor(!1),a=!wt(t,n);a||e.getLine(t.line).length!=t.ch?e.replaceRange("",t,a?n:St(t.line),"+delete"):e.replaceRange("",t,St(t.line+1,0),"+delete")},deleteLine:function(e){var t=e.getCursor().line;e.replaceRange("",St(t,0),St(t),"+delete")},undo:function(e){e.undo()},redo:function(e){e.redo()},goDocStart:function(e){e.extendSelection(St(e.firstLine(),0))},goDocEnd:function(e){e.extendSelection(St(e.lastLine()))},goLineStart:function(e){e.extendSelection(Na(e,e.getCursor().line))},goLineStartSmart:function(e){var t=e.getCursor(),n=Na(e,t.line),a=e.getLineHandle(n.line),i=$n(a);i&&0!=i[0].level?e.extendSelection(n):(a=Math.max(0,a.text.search(/\S/)),e.extendSelection(St(n.line,t.line==n.line&&t.ch<=a&&t.ch?0:a)))},goLineEnd:function(e){e.extendSelection(xa(e,e.getCursor().line))},goLineUp:function(e){e.moveV(-1,"line")},goLineDown:function(e){e.moveV(1,"line")},goPageUp:function(e){e.moveV(-1,"page")},goPageDown:function(e){e.moveV(1,"page")},goCharLeft:function(e){e.moveH(-1,"char")},goCharRight:function(e){e.moveH(1,"char")},goColumnLeft:function(e){e.moveH(-1,"column")},goColumnRight:function(e){e.moveH(1,"column")},goWordLeft:function(e){e.moveH(-1,"word")},goWordRight:function(e){e.moveH(1,"word")},delCharBefore:function(e){e.deleteH(-1,"char")},delCharAfter:function(e){e.deleteH(1,"char")},delWordBefore:function(e){e.deleteH(-1,"word")},delWordAfter:function(e){e.deleteH(1,"word")},indentAuto:function(e){e.indentSelection("smart")},indentMore:function(e){e.indentSelection("add")},indentLess:function(e){e.indentSelection("subtract")},insertTab:function(e){e.replaceSelection("	","end","+input")},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.replaceSelection("	","end","+input")},transposeChars:function(e){var t=e.getCursor(),n=e.getLine(t.line);0<t.ch&&t.ch<n.length-1&&e.replaceRange(n.charAt(t.ch)+n.charAt(t.ch-1),St(t.line,t.ch-1),St(t.line,t.ch+1))},newlineAndIndent:function(e){$(e,function(){e.replaceSelection("\n","end","+input"),e.indentLine(e.getCursor().line,null,!0)})()},toggleOverwrite:function(e){e.toggleOverwrite()}},ki=e.keyMap={};ki.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite"},ki.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Alt-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd","Ctrl-Left":"goWordLeft","Ctrl-Right":"goWordRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delWordBefore","Ctrl-Delete":"delWordAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore",fallthrough:"basic"},ki.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goWordLeft","Alt-Right":"goWordRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delWordBefore","Ctrl-Alt-Backspace":"delWordAfter","Alt-Delete":"delWordAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore",fallthrough:["basic","emacsy"]},ki["default"]=Qa?ki.macDefault:ki.pcDefault,ki.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},e.lookupKey=Qt,e.isModifierKey=Jt,e.keyName=en,e.fromTextArea=function(t,n){function a(){t.value=c.getValue()}if(n||(n={}),n.value=t.value,!n.tabindex&&t.tabindex&&(n.tabindex=t.tabindex),null==n.autofocus){var i=document.body;try{i=document.activeElement}catch(o){}n.autofocus=i==t||null!=t.getAttribute("autofocus")&&i==document.body}if(t.form){oa(t.form,"submit",a);var r=t.form,l=r.submit;try{var s=r.submit=function(){a(),r.submit=l,r.submit(),r.submit=s}}catch(d){}}t.style.display="none";var c=e(function(e){t.parentNode.insertBefore(e,t.nextSibling)},n);return c.save=a,c.getTextArea=function(){return t},c.toTextArea=function(){a(),t.parentNode.removeChild(c.getWrapperElement()),t.style.display="",t.form&&(ra(t.form,"submit",a),"function"==typeof t.form.submit&&(t.form.submit=l))},c},tn.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return 0==this.pos},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(e){var t=this.string.charAt(this.pos);return("string"==typeof e?t==e:t&&(e.test?e.test(t):e(t)))?(++this.pos,t):void 0},eatWhile:function(e){for(var t=this.pos;this.eat(e););return this.pos>t},eatSpace:function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){return e=this.string.indexOf(e,this.pos),e>-1?(this.pos=e,!0):void 0},backUp:function(e){this.pos-=e},column:function(){return pa(this.string,this.start,this.tabSize)},indentation:function(){return pa(this.string,null,this.tabSize)},match:function(e,t,n){return"string"!=typeof e?(e=this.string.slice(this.pos).match(e))&&0<e.index?null:(e&&!1!==t&&(this.pos+=e[0].length),e):(n?this.string.toLowerCase():this.string).indexOf(n?e.toLowerCase():e,this.pos)==this.pos?(!1!==t&&(this.pos+=e.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)}},e.StringStream=tn,e.TextMarker=nn,nn.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,t=e&&!e.curOp;t&&j(e);for(var n=null,a=null,i=0;i<this.lines.length;++i){var o=this.lines[i],r=ln(o.markedSpans,this);null!=r.to&&(a=Mn(o));for(var l=o,d=o.markedSpans,c=r,u=void 0,p=0;p<d.length;++p)d[p]!=c&&(u||(u=[])).push(d[p]);l.markedSpans=u,null!=r.from?n=Mn(o):this.collapsed&&!hn(this.doc,o)&&e&&zn(o,z(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(i=0;i<this.lines.length;++i)o=mn(e.doc,this.lines[i]),r=s(e.doc,o),r>e.display.maxLineLength&&(e.display.maxLine=o,e.display.maxLineLength=r,e.display.maxLineChanged=!0);null!=n&&e&&V(e,n,a+1),this.lines.length=0,this.explicitlyCleared=!0,this.collapsed&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&Bt(e)),t&&H(e),sa(this,"clear")}},nn.prototype.find=function(){for(var e,t,n=0;n<this.lines.length;++n){var a=this.lines[n],i=ln(a.markedSpans,this);(null!=i.from||null!=i.to)&&(a=Mn(a),null!=i.from&&(e=St(a,i.from)),null!=i.to&&(t=St(a,i.to)))}return"bookmark"==this.type?e:e&&{from:e,to:t}},nn.prototype.getOptions=function(e){var t=this.replacedWith;return{className:this.className,inclusiveLeft:this.inclusiveLeft,inclusiveRight:this.inclusiveRight,atomic:this.atomic,collapsed:this.collapsed,clearOnEnter:this.clearOnEnter,replacedWith:e?t&&t.cloneNode(!0):t,readOnly:this.readOnly,startStyle:this.startStyle,endStyle:this.endStyle}},nn.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&-1!=fa(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},nn.prototype.detachLine=function(e){this.lines.splice(fa(this.lines,e),1),!this.lines.length&&this.doc.cm&&(e=this.doc.cm.curOp,(e.maybeHiddenMarkers||(e.maybeHiddenMarkers=[])).push(this))},e.SharedTextMarker=on,on.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();sa(this,"clear")}},on.prototype.find=function(){return this.primary.find()},on.prototype.getOptions=function(e){return e=this.primary.getOptions(e),e.shared=!0,e};var yi=e.LineWidget=function(e,t,n){for(var a in n)n.hasOwnProperty(a)&&(this[a]=n[a]);this.cm=e,this.node=t};yi.prototype.clear=vn(function(){var e=this.line.widgets,t=Mn(this.line);if(null!=t&&e){for(var n=0;n<e.length;++n)e[n]==this&&e.splice(n--,1);e.length||(this.line.widgets=null),zn(this.line,Math.max(0,this.line.height-Tn(this))),V(this.cm,t,t+1)}}),yi.prototype.changed=vn(function(){var e=this.height;this.height=null,(e=Tn(this)-e)&&(zn(this.line,this.line.height+e),e=Mn(this.line),V(this.cm,e,e+1))});var Ri={},Ii=/[\t\u0000-\u0019\u200b\u2028\u2029\uFEFF]/g;Kn.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var n=e,a=e+t;a>n;++n){var i=this.lines[n];this.height-=i.height;var o=i;o.parent=null,fn(o),sa(i,"delete")}this.lines.splice(e,t)},collapse:function(e){e.splice.apply(e,[e.length,0].concat(this.lines))},insertInner:function(e,t,n){for(this.height+=n,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e)),e=0,n=t.length;n>e;++e)t[e].parent=this},iterN:function(e,t,n){for(t=e+t;t>e;++e)if(n(this.lines[e]))return!0}},Nn.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var n=0;n<this.children.length;++n){var a=this.children[n],i=a.chunkSize();if(i>e){var o=Math.min(t,i-e),r=a.height;if(a.removeInner(e,o),this.height-=r-a.height,i==o&&(this.children.splice(n--,1),a.parent=null),0==(t-=o))break;e=0}else e-=i}25>this.size-t&&(n=[],this.collapse(n),this.children=[new Kn(n)],this.children[0].parent=this)},collapse:function(e){for(var t=0,n=this.children.length;n>t;++t)this.children[t].collapse(e)},insertInner:function(e,t,n){this.size+=t.length,this.height+=n;for(var a=0,i=this.children.length;i>a;++a){var o=this.children[a],r=o.chunkSize();if(r>=e){if(o.insertInner(e,t,n),o.lines&&50<o.lines.length){for(;50<o.lines.length;)e=o.lines.splice(o.lines.length-25,25),e=new Kn(e),o.height-=e.height,this.children.splice(a+1,0,e),e.parent=this;this.maybeSpill()}break}e-=r}},maybeSpill:function(){if(!(10>=this.children.length)){var e=this;do{var t=e.children.splice(e.children.length-5,5),t=new Nn(t);if(e.parent){e.size-=t.size,e.height-=t.height;var n=fa(e.parent.children,e);e.parent.children.splice(n+1,0,t)}else n=new Nn(e.children),n.parent=e,e.children=[n,t],e=n;t.parent=e.parent}while(10<e.children.length);e.parent.maybeSpill()}},iterN:function(e,t,n){for(var a=0,i=this.children.length;i>a;++a){var o=this.children[a],r=o.chunkSize();if(r>e){if(r=Math.min(t,r-e),o.iterN(e,r,n))return!0;if(0==(t-=r))break;e=0}else e-=r}}};var Di=0,Oi=e.Doc=function(e,t,n){return this instanceof Oi?(null==n&&(n=0),Nn.call(this,[new Kn([Cn("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.history=Un(),this.frontier=n,n=St(n,0),this.sel={from:n,to:n,head:n,anchor:n,shift:!1,extend:!1,goalColumn:null},this.id=++Di,this.modeOption=t,"string"==typeof e&&(e=ji(e)),void An(this,{from:n,to:n,text:e},null,{head:n,anchor:n})):new Oi(e,t,n)};Oi.prototype=function(e,t){function n(){}n.prototype=e;var a=new n;return t&&ba(t,a),a}(Nn.prototype,{iter:function(e,t,n){n?this.iterN(e-this.first,t-e,n):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var n=0,a=0,i=t.length;i>a;++a)n+=t[a].height;this.insertInner(e-this.first,t,n)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=Fn(this,this.first,this.first+this.size);return!1===e?t:t.join(e||"\n")},setValue:function(e){var t=St(this.first,0),n=this.first+this.size-1;Ct(this,{from:t,to:St(n,Pn(this,n).text.length),text:ji(e),origin:"setValue"},{head:t,anchor:t},!0)},replaceRange:function(e,t,n,a){t=Kt(this,t),n=n?Kt(this,n):t,Ot(this,e,t,n,a)},getRange:function(e,t,n){return e=Bn(this,Kt(this,e),Kt(this,t)),!1===n?e:e.join(n||"\n")},getLine:function(e){return(e=this.getLineHandle(e))&&e.text},setLine:function(e,t){xt(this,e)&&Ot(this,t,St(e,0),Kt(this,St(e)))},removeLine:function(e){xt(this,e)&&Ot(this,"",St(e,0),Kt(this,St(e+1,0)))},getLineHandle:function(e){return xt(this,e)?Pn(this,e):void 0},getLineNumber:function(e){return Mn(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return Kt(this,e)},getCursor:function(e){var t=this.sel;return At(null==e||"head"==e?t.head:"anchor"==e?t.anchor:"end"==e||!1===e?t.to:t.from)},somethingSelected:function(){return!wt(this.sel.head,this.sel.anchor)},setCursor:U(function(e,t,n){e=Kt(this,"number"==typeof e?St(e,t||0):e),n?Lt(this,e):Pt(this,e,e)}),setSelection:U(function(e,t){Pt(this,Kt(this,e),Kt(this,t||e))}),extendSelection:U(function(e,t){Lt(this,Kt(this,e),t&&Kt(this,t))}),getSelection:function(e){return this.getRange(this.sel.from,this.sel.to,e)},replaceSelection:function(e,t,n){Ct(this,{from:this.sel.from,to:this.sel.to,text:ji(e),origin:n},t||"around")},undo:U(function(){yt(this,"undo")}),redo:U(function(){yt(this,"redo")}),setExtending:function(e){this.sel.extend=e},historySize:function(){var e=this.history;return{undo:e.done.length,redo:e.undone.length}},clearHistory:function(){this.history=Un()},markClean:function(){this.history.dirtyCounter=0,this.history.lastOp=this.history.lastOrigin=null},isClean:function(){return 0==this.history.dirtyCounter},getHistory:function(){return{done:Yn(this.history.done),undone:Yn(this.history.undone)}},setHistory:function(e){var t=this.history=Un();t.done=e.done.slice(0),t.undone=e.undone.slice(0)},markText:function(e,t,n){return an(this,Kt(this,e),Kt(this,t),n,"range")},setBookmark:function(e,t){var n={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft},e=Kt(this,e);return an(this,e,e,n,"bookmark")},findMarksAt:function(e){var e=Kt(this,e),t=[],n=Pn(this,e.line).markedSpans;if(n)for(var a=0;a<n.length;++a){var i=n[a];(null==i.from||i.from<=e.ch)&&(null==i.to||i.to>=e.ch)&&t.push(i.marker.parent||i.marker)}return t},getAllMarks:function(){var e=[];return this.iter(function(t){if(t=t.markedSpans)for(var n=0;n<t.length;++n)null!=t[n].from&&e.push(t[n].marker)}),e},posFromIndex:function(e){var t,n=this.first;return this.iter(function(a){return a=a.text.length+1,a>e?(t=e,!0):(e-=a,void++n)}),Kt(this,St(n,t))},indexFromPos:function(e){var e=Kt(this,e),t=e.ch;return e.line<this.first||0>e.ch?0:(this.iter(this.first,e.line,function(e){t+=e.text.length+1}),t)},copy:function(e){var t=new Oi(Fn(this,this.first,this.first+this.size),this.modeOption,this.first);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel={from:this.sel.from,to:this.sel.to,head:this.sel.head,anchor:this.sel.anchor,shift:this.sel.shift,extend:!1,goalColumn:this.sel.goalColumn},e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,n=this.first+this.size;return null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<n&&(n=e.to),t=new Oi(Fn(this,t,n),e.mode||this.modeOption,t),e.sharedHist&&(t.history=this.history),(this.linked||(this.linked=[])).push({doc:t,sharedHist:e.sharedHist}),t.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],t},unlinkDoc:function(t){if(t instanceof e&&(t=t.doc),this.linked)for(var n=0;n<this.linked.length;++n)if(this.linked[n].doc==t){this.linked.splice(n,1),t.unlinkDoc(this);break}if(t.history==this.history){var a=[t.id];xn(t,function(e){a.push(e.id)},!0),t.history=Un(),t.history.done=Yn(this.history.done,a),t.history.undone=Yn(this.history.undone,a)}},iterLinkedDocs:function(e){xn(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm}}),Oi.prototype.eachLine=Oi.prototype.iter;var Si,wi=["iter","insert","remove","copy","getEditor"];for(Si in Oi.prototype)Oi.prototype.hasOwnProperty(Si)&&0>fa(wi,Si)&&(e.prototype[Si]=function(e){return function(){return e.apply(this.doc,arguments)}}(Oi.prototype[Si]));e.e_stop=aa,e.e_preventDefault=ta,e.e_stopPropagation=na;var _i,Ai=0;e.on=oa,e.off=ra,e.signal=la;var Ki=30,Ni=e.Pass={toString:function(){return"CodeMirror.Pass"}};ua.prototype={set:function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)}},e.countColumn=pa;var xi=[""],Li=/[\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc]/,Pi=/[\u0300-\u036F\u0483-\u0487\u0488-\u0489\u0591-\u05BD\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7-\u06E8\u06EA-\u06ED\uA66F\uA670-\uA672\uA674-\uA67D\uA69F\udc00-\udfff]/;e.replaceGetRect=function(e){Da=e};var Bi=function(){if(Ma)return!1;var e=ka("div");return"draggable"in e||"dragDrop"in e}(),Fi=/^$/;Ba?Fi=/$'/:Wa?Fi=/\-[^ \-?]|\?[^ !'\"\),.\-\/:;\?\]\}]/:$a&&(Fi=/\-[^ \-\.?]|\?[^ \-\.?\]\}:;!'\"\),\/]|[\.!\"#&%\)*+,:;=>\]|\}~][\(\{\[<]|\$'/);var zi,Mi,ji=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,n=[],a=e.length;a>=t;){var i=e.indexOf("\n",t);-1==i&&(i=e.length);var o=e.slice(t,"\r"==e.charAt(i-1)?i-1:i),r=o.indexOf("\r");-1!=r?(n.push(o.slice(0,r)),t+=r+1):(n.push(o),t=i+1)}return n}:function(e){return e.split(/\r\n?|\n/)};e.splitLines=ji;var Hi=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(t){return!1}}:function(e){try{var t=e.ownerDocument.selection.createRange()}catch(n){}return t&&t.parentElement()==e?0!=t.compareEndPoints("StartToEnd",t):!1},$i=function(){var e=ka("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy)}(),Ui={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",91:"Mod",92:"Mod",93:"Mod",109:"-",107:"=",127:"Delete",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63276:"PageUp",63277:"PageDown",63275:"End",63273:"Home",63234:"Left",63232:"Up",63235:"Right",63233:"Down",63302:"Insert",63272:"Delete"};e.keyNames=Ui,function(){for(var e=0;10>e;e++)Ui[e+48]=""+e;for(e=65;90>=e;e++)Ui[e]=String.fromCharCode(e);for(e=1;12>=e;e++)Ui[e+111]=Ui[e+63235]="F"+e}();var Wi=function(){function e(e){return 255>=e?t.charAt(e):e>=1424&&1524>=e?"R":e>=1536&&1791>=e?n.charAt(e-1536):e>=1792&&2220>=e?"r":"L"}var t="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLL",n="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmmrrrrrrrrrrrrrrrrrr",a=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,i=/[stwN]/,o=/[LRr]/,r=/[Lb1n]/,l=/[1n]/;return function(t){if(!a.test(t))return!1;for(var n,s=t.length,d=[],c=0;s>c;++c)d.push(e(t.charCodeAt(c)));for(var c=0,u="L";s>c;++c)n=d[c],"m"==n?d[c]=u:u=n;for(c=0,u="L";s>c;++c)n=d[c],"1"==n&&"r"==u?d[c]="n":o.test(n)&&(u=n,"r"==n&&(d[c]="R"));for(c=1,u=d[0];s-1>c;++c)n=d[c],"+"==n&&"1"==u&&"1"==d[c+1]?d[c]="1":","!=n||u!=d[c+1]||"1"!=u&&"n"!=u||(d[c]=u),u=n;for(c=0;s>c;++c)if(n=d[c],","==n)d[c]="N";else if("%"==n){for(u=c+1;s>u&&"%"==d[u];++u);var p=c&&"!"==d[c-1]||s-1>u&&"1"==d[u]?"1":"N";for(n=c;u>n;++n)d[n]=p;c=u-1}for(c=0,u="L";s>c;++c)n=d[c],"L"==u&&"1"==n?d[c]="L":o.test(n)&&(u=n);for(c=0;s>c;++c)if(i.test(d[c])){for(u=c+1;s>u&&i.test(d[u]);++u);for(n="L"==(s-1>u?d[u]:"L"),p="L"==(c?d[c-1]:"L")||n?"L":"R",n=c;u>n;++n)d[n]=p;c=u-1}for(var m,u=[],c=0;s>c;)if(r.test(d[c])){for(n=c,++c;s>c&&r.test(d[c]);++c);u.push({from:n,to:c,level:0})}else{var h=c,p=u.length;for(++c;s>c&&"L"!=d[c];++c);for(n=h;c>n;)if(l.test(d[n])){for(n>h&&u.splice(p,0,{from:h,to:n,level:1}),h=n,++n;c>n&&l.test(d[n]);++n);u.splice(p,0,{from:h,to:n,level:2}),h=n}else++n;c>h&&u.splice(p,0,{from:h,to:c,level:1})}return 1==u[0].level&&(m=t.match(/^\s+/))&&(u[0].from=m[0].length,u.unshift({from:0,to:m[0].length,level:0})),1==ha(u).level&&(m=t.match(/\s+$/))&&(ha(u).to-=m[0].length,u.push({from:s-m[0].length,to:s,level:0})),u[0].level!=ha(u).level&&u.push({from:s,to:s,level:u[0].level}),u}}();return e.version="3.1",e}();