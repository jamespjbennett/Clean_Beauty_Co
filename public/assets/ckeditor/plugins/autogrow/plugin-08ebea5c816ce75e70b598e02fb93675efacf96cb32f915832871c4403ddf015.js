/**
 * @license Copyright (c) 2003-2013, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.html or http://ckeditor.com/license
 */
!function(){function e(e){var t=e.getStyle("overflow-y"),n=e.getDocument(),i=CKEDITOR.dom.element.createFromHtml('<span style="margin:0;padding:0;border:0;clear:both;width:1px;height:1px;display:block;">'+(CKEDITOR.env.webkit?"&nbsp;":"")+"</span>",n);n[CKEDITOR.env.ie?"getBody":"getDocumentElement"]().append(i);var a=i.getDocumentPosition(n).y+i.$.offsetHeight;return i.remove(),e.setStyle("overflow-y",t),a}function t(e){var t=e.document,n=t.getBody(),i=t.getDocumentElement();return"BackCompat"==t.$.compatMode?n:i}var n=function(n){if(n.window){var i=n.getCommand("maximize");if(!i||i.state!=CKEDITOR.TRISTATE_ON){var a=t(n),o=n.window.getViewPaneSize().height,r=e(a);r+=n.config.autoGrow_bottomSpace||0;var l=void 0!=n.config.autoGrow_minHeight?n.config.autoGrow_minHeight:200,s=n.config.autoGrow_maxHeight||1/0;r=Math.max(r,l),r=Math.min(r,s),r!=o&&(r=n.fire("autoGrow",{currentHeight:o,newHeight:r}).newHeight,n.resize(n.container.getStyle("width"),r,!0)),a.$.scrollHeight>a.$.clientHeight&&s>r?a.setStyle("overflow-y","hidden"):a.removeStyle("overflow-y")}}};CKEDITOR.plugins.add("autogrow",{init:function(e){e.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE&&e.on("instanceReady",function(){var i=e.editable();if(i.isInline())e.ui.space("contents").setStyle("height","auto");else{e.addCommand("autogrow",{exec:n,modes:{wysiwyg:1},readOnly:1,canUndo:!1,editorFocus:!1});var a={contentDom:1,key:1,selectionChange:1,insertElement:1,mode:1};for(var o in a)e.on(o,function(e){"wysiwyg"==e.editor.mode&&setTimeout(function(){n(e.editor),n(e.editor)},100)});e.on("afterCommandExec",function(i){if("maximize"==i.data.name&&"wysiwyg"==i.editor.mode)if(i.data.command.state==CKEDITOR.TRISTATE_ON){var a=t(e);a.removeStyle("overflow")}else n(e)}),e.config.autoGrow_onStartup&&e.execCommand("autogrow")}})}})}();